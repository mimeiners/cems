<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Erdem Agfirat">
<meta name="author" content="Atakan Baydogan">
<meta name="author" content="Agah Osman Celebi">

<title>3&nbsp; Design of an Analog-to-Digital Converter – Concept Engineering Mixed-Technology Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../lab/elie2/index.html" rel="next">
<link href="../../lec/lec-01-intro.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b7c2d8834e08b04a63bb76a724ffbcac.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../lab/elie1/index.html">Design Reports</a></li><li class="breadcrumb-item"><a href="../../lab/elie1/index.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Design of an Analog-to-Digital Converter</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Concept Engineering Mixed-Technology Systems</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mimeiners/cems/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Unsyllabus</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Lecture</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lec/lec-01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction and Survey</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Design Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lab/elie1/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Design of an Analog-to-Digital Converter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lab/elie2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Discrete-Time Delta-Sigma Modulator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lab/elie3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Design of an Analog-to-Digital Converter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lab/elie4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Design of an Analog-Digital-Converter after the ADS1115</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lab/elie5/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">MBSE of a Delta Sigma Modulator based IC Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#system-overview" id="toc-system-overview" class="nav-link" data-scroll-target="#system-overview"><span class="header-section-number">4.1</span> System Overview</a>
  <ul class="collapse">
  <li><a href="#adxl335-block-diagram" id="toc-adxl335-block-diagram" class="nav-link" data-scroll-target="#adxl335-block-diagram"><span class="header-section-number">4.1.1</span> ADXL335 Block Diagram</a></li>
  <li><a href="#ads1115-block-diagram" id="toc-ads1115-block-diagram" class="nav-link" data-scroll-target="#ads1115-block-diagram"><span class="header-section-number">4.1.2</span> ADS1115 Block Diagram</a></li>
  <li><a href="#esp8266-pinout-diagram" id="toc-esp8266-pinout-diagram" class="nav-link" data-scroll-target="#esp8266-pinout-diagram"><span class="header-section-number">4.1.3</span> ESP8266 Pinout Diagram</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#analog-to-digital-converter" id="toc-analog-to-digital-converter" class="nav-link" data-scroll-target="#analog-to-digital-converter"><span class="header-section-number">5</span> Analog-to-Digital Converter</a>
  <ul class="collapse">
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling"><span class="header-section-number">5.1</span> Sampling</a></li>
  <li><a href="#quantization" id="toc-quantization" class="nav-link" data-scroll-target="#quantization"><span class="header-section-number">5.2</span> Quantization</a></li>
  </ul></li>
  <li><a href="#delta-sigma-adcs" id="toc-delta-sigma-adcs" class="nav-link" data-scroll-target="#delta-sigma-adcs"><span class="header-section-number">6</span> Delta-Sigma ADCs</a>
  <ul class="collapse">
  <li><a href="#system-outline" id="toc-system-outline" class="nav-link" data-scroll-target="#system-outline"><span class="header-section-number">6.1</span> System Outline</a></li>
  <li><a href="#fundamental-concepts" id="toc-fundamental-concepts" class="nav-link" data-scroll-target="#fundamental-concepts"><span class="header-section-number">6.2</span> Fundamental Concepts</a></li>
  <li><a href="#oversampling" id="toc-oversampling" class="nav-link" data-scroll-target="#oversampling"><span class="header-section-number">6.3</span> Oversampling</a></li>
  <li><a href="#noise-shaping" id="toc-noise-shaping" class="nav-link" data-scroll-target="#noise-shaping"><span class="header-section-number">6.4</span> Noise shaping</a>
  <ul class="collapse">
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model"><span class="header-section-number">6.4.1</span> Linear Model</a></li>
  </ul></li>
  <li><a href="#second-order-delta-sigma-modulation" id="toc-second-order-delta-sigma-modulation" class="nav-link" data-scroll-target="#second-order-delta-sigma-modulation"><span class="header-section-number">6.5</span> Second-Order Delta-Sigma Modulation</a></li>
  <li><a href="#decimation" id="toc-decimation" class="nav-link" data-scroll-target="#decimation"><span class="header-section-number">6.6</span> Decimation</a>
  <ul class="collapse">
  <li><a href="#two-stage-decimator-structure" id="toc-two-stage-decimator-structure" class="nav-link" data-scroll-target="#two-stage-decimator-structure"><span class="header-section-number">6.6.1</span> Two-Stage Decimator Structure</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#implementation-and-analysis-of-behavior-with-matlab-and-simulink" id="toc-implementation-and-analysis-of-behavior-with-matlab-and-simulink" class="nav-link" data-scroll-target="#implementation-and-analysis-of-behavior-with-matlab-and-simulink"><span class="header-section-number">7</span> Implementation and Analysis of Behavior with MATLAB and Simulink</a></li>
  <li><a href="#switched-capacitor" id="toc-switched-capacitor" class="nav-link" data-scroll-target="#switched-capacitor"><span class="header-section-number">8</span> Switched Capacitor</a>
  <ul class="collapse">
  <li><a href="#clock-phases-in-switched-capacitor-circuits" id="toc-clock-phases-in-switched-capacitor-circuits" class="nav-link" data-scroll-target="#clock-phases-in-switched-capacitor-circuits"><span class="header-section-number">8.1</span> Clock Phases in Switched Capacitor Circuits</a>
  <ul class="collapse">
  <li><a href="#non-overlapping-clock-phases" id="toc-non-overlapping-clock-phases" class="nav-link" data-scroll-target="#non-overlapping-clock-phases"><span class="header-section-number">8.1.1</span> Non-overlapping Clock Phases</a></li>
  </ul></li>
  <li><a href="#timing-diagrams-for-switched-capacitor-operation" id="toc-timing-diagrams-for-switched-capacitor-operation" class="nav-link" data-scroll-target="#timing-diagrams-for-switched-capacitor-operation"><span class="header-section-number">8.2</span> Timing Diagrams for Switched Capacitor Operation</a></li>
  <li><a href="#basic-switched-capacitor-circuit-operation" id="toc-basic-switched-capacitor-circuit-operation" class="nav-link" data-scroll-target="#basic-switched-capacitor-circuit-operation"><span class="header-section-number">8.3</span> Basic Switched Capacitor Circuit Operation</a>
  <ul class="collapse">
  <li><a href="#operating-principle" id="toc-operating-principle" class="nav-link" data-scroll-target="#operating-principle"><span class="header-section-number">8.3.1</span> Operating Principle</a></li>
  </ul></li>
  <li><a href="#area-efficiency-and-frequency-control-in-switched-capacitor-circuits" id="toc-area-efficiency-and-frequency-control-in-switched-capacitor-circuits" class="nav-link" data-scroll-target="#area-efficiency-and-frequency-control-in-switched-capacitor-circuits"><span class="header-section-number">8.4</span> Area Efficiency and Frequency Control in Switched Capacitor Circuits</a></li>
  </ul></li>
  <li><a href="#ltspice-simulation-of-an-idealized-second-order-sigma-delta-modulator" id="toc-ltspice-simulation-of-an-idealized-second-order-sigma-delta-modulator" class="nav-link" data-scroll-target="#ltspice-simulation-of-an-idealized-second-order-sigma-delta-modulator"><span class="header-section-number">9</span> LTSpice Simulation of an Idealized Second-Order Sigma-Delta Modulator</a>
  <ul class="collapse">
  <li><a href="#key-components-and-operation" id="toc-key-components-and-operation" class="nav-link" data-scroll-target="#key-components-and-operation"><span class="header-section-number">9.1</span> Key Components and Operation</a></li>
  <li><a href="#output-signals-of-the-first-and-second-integrator-stages" id="toc-output-signals-of-the-first-and-second-integrator-stages" class="nav-link" data-scroll-target="#output-signals-of-the-first-and-second-integrator-stages"><span class="header-section-number">9.2</span> Output Signals of the First and Second Integrator Stages</a>
  <ul class="collapse">
  <li><a href="#integrator-1-output---vvx1" id="toc-integrator-1-output---vvx1" class="nav-link" data-scroll-target="#integrator-1-output---vvx1"><span class="header-section-number">9.2.1</span> Integrator 1 Output - V(vx1)</a></li>
  <li><a href="#integrator-2-output---vvx2" id="toc-integrator-2-output---vvx2" class="nav-link" data-scroll-target="#integrator-2-output---vvx2"><span class="header-section-number">9.2.2</span> Integrator 2 Output - V(vx2)</a></li>
  <li><a href="#output-waveforms-visualization" id="toc-output-waveforms-visualization" class="nav-link" data-scroll-target="#output-waveforms-visualization"><span class="header-section-number">9.2.3</span> Output Waveforms Visualization</a></li>
  </ul></li>
  <li><a href="#ltspice-ota-representation" id="toc-ltspice-ota-representation" class="nav-link" data-scroll-target="#ltspice-ota-representation"><span class="header-section-number">9.3</span> LTspice OTA representation</a>
  <ul class="collapse">
  <li><a href="#behavioral-model-of-the-ota-in-ltspice" id="toc-behavioral-model-of-the-ota-in-ltspice" class="nav-link" data-scroll-target="#behavioral-model-of-the-ota-in-ltspice"><span class="header-section-number">9.3.1</span> Behavioral Model of the OTA in LTSpice</a></li>
  <li><a href="#transistor-level-of-the-ota" id="toc-transistor-level-of-the-ota" class="nav-link" data-scroll-target="#transistor-level-of-the-ota"><span class="header-section-number">9.3.2</span> Transistor-Level of the OTA</a></li>
  <li><a href="#comparison-between-the-models" id="toc-comparison-between-the-models" class="nav-link" data-scroll-target="#comparison-between-the-models"><span class="header-section-number">9.3.3</span> Comparison Between the Models</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#basic-ota-sizing-strategy" id="toc-basic-ota-sizing-strategy" class="nav-link" data-scroll-target="#basic-ota-sizing-strategy"><span class="header-section-number">10</span> Basic OTA Sizing Strategy</a></li>
  <li><a href="#incremental-delta-sigma-modulators" id="toc-incremental-delta-sigma-modulators" class="nav-link" data-scroll-target="#incremental-delta-sigma-modulators"><span class="header-section-number">11</span> Incremental Delta Sigma Modulators</a>
  <ul class="collapse">
  <li><a href="#iic-tools-and-ihp-sg13g2-pdk" id="toc-iic-tools-and-ihp-sg13g2-pdk" class="nav-link" data-scroll-target="#iic-tools-and-ihp-sg13g2-pdk"><span class="header-section-number">11.1</span> IIC-Tools and IHP-SG13G2 PDK</a></li>
  </ul></li>
  <li><a href="#ingegrated-circuit-design" id="toc-ingegrated-circuit-design" class="nav-link" data-scroll-target="#ingegrated-circuit-design"><span class="header-section-number">12</span> Ingegrated Circuit Design</a>
  <ul class="collapse">
  <li><a href="#operational-amplifier" id="toc-operational-amplifier" class="nav-link" data-scroll-target="#operational-amplifier"><span class="header-section-number">12.1</span> Operational Amplifier</a></li>
  <li><a href="#gmid---methodology" id="toc-gmid---methodology" class="nav-link" data-scroll-target="#gmid---methodology"><span class="header-section-number">12.2</span> gm/ID - Methodology</a></li>
  <li><a href="#subcomponents-systems-of-the-incremental-delta-sigma-modulator" id="toc-subcomponents-systems-of-the-incremental-delta-sigma-modulator" class="nav-link" data-scroll-target="#subcomponents-systems-of-the-incremental-delta-sigma-modulator"><span class="header-section-number">12.3</span> Subcomponents/-systems of the incremental Delta-Sigma Modulator</a>
  <ul class="collapse">
  <li><a href="#voltage-reference" id="toc-voltage-reference" class="nav-link" data-scroll-target="#voltage-reference"><span class="header-section-number">12.3.1</span> Voltage Reference</a></li>
  <li><a href="#voltage-controlled-ring-oscillator" id="toc-voltage-controlled-ring-oscillator" class="nav-link" data-scroll-target="#voltage-controlled-ring-oscillator"><span class="header-section-number">12.3.2</span> Voltage Controlled Ring Oscillator</a></li>
  <li><a href="#clock-generatorsplitter-with-delay-circuit" id="toc-clock-generatorsplitter-with-delay-circuit" class="nav-link" data-scroll-target="#clock-generatorsplitter-with-delay-circuit"><span class="header-section-number">12.3.3</span> Clock Generator/Splitter with delay circuit</a></li>
  <li><a href="#inverter-as-integrator" id="toc-inverter-as-integrator" class="nav-link" data-scroll-target="#inverter-as-integrator"><span class="header-section-number">12.3.4</span> Inverter as Integrator</a></li>
  <li><a href="#clocked-comparator" id="toc-clocked-comparator" class="nav-link" data-scroll-target="#clocked-comparator"><span class="header-section-number">12.3.5</span> Clocked Comparator</a></li>
  <li><a href="#bit-dac" id="toc-bit-dac" class="nav-link" data-scroll-target="#bit-dac"><span class="header-section-number">12.3.6</span> 1-Bit DAC</a></li>
  </ul></li>
  <li><a href="#first-order-delta-sigma-modulator" id="toc-first-order-delta-sigma-modulator" class="nav-link" data-scroll-target="#first-order-delta-sigma-modulator"><span class="header-section-number">12.4</span> First Order Delta-Sigma Modulator</a></li>
  <li><a href="#second-order-delta-sigma-modulator" id="toc-second-order-delta-sigma-modulator" class="nav-link" data-scroll-target="#second-order-delta-sigma-modulator"><span class="header-section-number">12.5</span> Second Order Delta-Sigma Modulator</a></li>
  </ul></li>
  <li><a href="#testbed-design" id="toc-testbed-design" class="nav-link" data-scroll-target="#testbed-design"><span class="header-section-number">13</span> Testbed Design</a>
  <ul class="collapse">
  <li><a href="#pcb-design-for-a-board-to-evaluate-the-adc-ads1115" id="toc-pcb-design-for-a-board-to-evaluate-the-adc-ads1115" class="nav-link" data-scroll-target="#pcb-design-for-a-board-to-evaluate-the-adc-ads1115"><span class="header-section-number">13.1</span> PCB Design for a Board to Evaluate the ADC ADS1115</a></li>
  <li><a href="#design-steps" id="toc-design-steps" class="nav-link" data-scroll-target="#design-steps"><span class="header-section-number">13.2</span> Design Steps</a></li>
  <li><a href="#additional-features" id="toc-additional-features" class="nav-link" data-scroll-target="#additional-features"><span class="header-section-number">13.3</span> Additional Features</a></li>
  <li><a href="#block-diagram" id="toc-block-diagram" class="nav-link" data-scroll-target="#block-diagram"><span class="header-section-number">13.4</span> Block Diagram</a></li>
  <li><a href="#schematic" id="toc-schematic" class="nav-link" data-scroll-target="#schematic"><span class="header-section-number">13.5</span> Schematic</a></li>
  <li><a href="#input-power-regulation-and-usb-c-connector" id="toc-input-power-regulation-and-usb-c-connector" class="nav-link" data-scroll-target="#input-power-regulation-and-usb-c-connector"><span class="header-section-number">13.6</span> Input, Power Regulation and USB-C Connector</a></li>
  <li><a href="#esp8266-and-usb-to-uart" id="toc-esp8266-and-usb-to-uart" class="nav-link" data-scroll-target="#esp8266-and-usb-to-uart"><span class="header-section-number">13.7</span> ESP8266 and USB-to-UART</a></li>
  <li><a href="#adc-accelerometer-and-sma-signal-input-connectors" id="toc-adc-accelerometer-and-sma-signal-input-connectors" class="nav-link" data-scroll-target="#adc-accelerometer-and-sma-signal-input-connectors"><span class="header-section-number">13.8</span> ADC, Accelerometer and SMA Signal Input Connectors</a></li>
  <li><a href="#pcb-design" id="toc-pcb-design" class="nav-link" data-scroll-target="#pcb-design"><span class="header-section-number">13.9</span> PCB Design</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/mimeiners/cems/edit/main/lab/elie1/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mimeiners/cems/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../lab/elie1/index.html">Design Reports</a></li><li class="breadcrumb-item"><a href="../../lab/elie1/index.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Design of an Analog-to-Digital Converter</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Design of an Analog-to-Digital Converter</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Erdem Agfirat <a href="mailto:eagfirat@stud.hs-bremen.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.hs-bremen.de">
            Hochschule Bremen
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Atakan Baydogan <a href="mailto:abaydogan@stud.hs-bremen.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Agah Osman Celebi <a href="mailto:acelebi@stud.hs-bremen.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Introduction</h1>
<p>As the availability of standardized integrated circuit solutions decreases, the demand for tailored, application-specific designs is on the rise <span class="citation" data-cites="Dobkin2011">Dobkin and Williams (<a href="../elie4/index.html#ref-Dobkin2011" role="doc-biblioref">2011</a>)</span>. In response to this trend, students participating in the “Concept Engineering Mixed-Technology Systems” course, led by Professor Meiners at The City University of Applied Sciences, have been given the task of designing an Analog-to-Digital Converter (ADC). The aim is to develop a suitable replacement for the Texas Instruments ADS1115, tailored to meet the requirements of a specified measurement system.</p>
<p>The role of data conversion is fundamental in modern electronics. As digital processing technology continues to advance, speeds have reached unprecedented levels, and semiconductor components are now manufactured with nanometer precision, enabling Gigahertz-level data rates as a standard. Despite these technological strides, the physical world remains inherently analog, creating a necessity for reliable conversion techniques to interface analog signals with high-performance digital systems <span class="citation" data-cites="kester2005data">Kester (<a href="../elie4/index.html#ref-kester2005data" role="doc-biblioref">2005</a>)</span>.</p>
<p>In modern mixed-signal circuits, analog signal processing is increasingly complemented by digital signal processing. This shift allows for the use of lower-quality analog components, offset by the complexity and efficiency of digital systems <span class="citation" data-cites="Baker2008">R. J. Baker (<a href="../elie4/index.html#ref-Baker2008" role="doc-biblioref">2008</a>)</span>. From an engineering perspective, this trade-off plays a crucial role in designing high-performance ADCs, where digital compensation techniques can improve accuracy while reducing reliance on precise analog circuitry. As a result, contemporary ADC architectures integrate sophisticated digital algorithms to enhance resolution and dynamic range while minimizing the impact of analog imperfections.</p>
<p>This necessity spans multiple fields, including acoustics, optics, and mechanical sensing. To ensure accurate digital representation of analog data, ADCs must operate with high speed, precision, and reliability, making them critical components in modern electronic applications.</p>
<p>The fundamental concept of interfacing the analog and digital domains is illustrated in <a href="#fig-Domains" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>. The diagram shows the sequential flow from analog input signals, through analog-to-digital conversion, followed by digital data processing, and finally through digital-to-analog conversion to produce an analog output. This process highlights the critical role of reliable data conversion techniques in modern mixed-signal systems.</p>
<div id="fig-Domains" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Domains-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Domains.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Domains-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Analog and Digital Domains
</figcaption>
</figure>
</div>
<p>This report explores one of the most effective ADC architectures: the Sigma-Delta converter. The following sections provide a theoretical overview of ADC operation, analyze key performance characteristics at the system level, and develop foundational circuit models that replicate the desired conversion behavior. Lastly, a detailed circuit design will be presented, verified through SPICE simulations in the xschem design environment, outlining practical implementation strategies for integrated circuit fabrication.</p>
<section id="system-overview" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="system-overview"><span class="header-section-number">4.1</span> System Overview</h2>
<p>The measurement system under consideration for this semester’s project is a classical mixed-signal architecture designed for precise data acquisition and processing. At its core, the system utilizes an accelerometer as the primary analog sensor, responsible for capturing physical acceleration data from the environment. This analog signal is inherently continuous and requires conversion into the digital domain to enable efficient processing, analysis, and communication.</p>
<p>To achieve this, the analog output from the accelerometer is fed into an ADC. The ADC performs the crucial task of sampling the continuous analog signal and quantizing it into discrete digital values. These digital signals can then be processed by a microontroller, which serves as the central processing unit for the system. Within the microcontroller, further operations such as filtering, data interpretation, and wireless communication can be performed, depending on the application requirements.</p>
<p>For the hardware implementation of this signal chain, the following components have been selected:</p>
<ul>
<li><p><strong>ADXL335 Accelerometer</strong><br>
A low-power, three-axis analog output accelerometer capable of measuring acceleration with a full-scale range of ±3 g. It provides a simple and reliable analog voltage output proportional to acceleration, making it ideal for integration into the system.</p></li>
<li><p><strong>ADS1115 ADC</strong><br>
A high-precision, 16-bit analog-to-digital converter from Texas Instruments. It features a programmable gain amplifier (PGA) and an I²C-compatible interface, offering excellent resolution and flexibility for capturing low-level analog signals from the accelerometer.</p></li>
<li><p><strong>ESP8266 Microcontroller</strong><br>
A highly integrated microcontroller with built-in Wi-Fi capability. It not only handles the digital data processing but also enables wireless communication, making it suitable for IoT-based measurement applications.</p></li>
</ul>
<p>This system architecture ensures a robust interface between the analog sensing domain and the digital processing domain, highlighting the importance of accurate data conversion and efficient signal processing in modern measurement systems.</p>
<p>The high-level architecture of the described measurement system is illustrated in <a href="#fig-Measurement_System" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> below. It shows the data flow from the analog accelerometer (ADXL335), through the analog-to-digital converter (ADS1115), and finally to the digital microcontroller (ESP8266) for further processing and communication.</p>
<div id="fig-Measurement_System" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Measurement_System-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Measurement_System.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Measurement_System-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Top-Level Measurement System
</figcaption>
</figure>
</div>
<p>In addition to the top-level architecture, the internal structure and functionality of the individual components are shown in the following figures. These diagrams provide insight into the signal flow and the key subsystems involved in the measurement system.</p>
<section id="adxl335-block-diagram" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="adxl335-block-diagram"><span class="header-section-number">4.1.1</span> ADXL335 Block Diagram</h3>
<p><a href="#fig-ADXL335" class="quarto-xref">Figure&nbsp;<span>4.3</span></a> presents the internal block diagram of the ADXL335 accelerometer. It consists of a three-axis MEMS sensor, followed by an AC amplifier and demodulator stage. Each axis output is then buffered through separate output amplifiers, providing analog voltage signals corresponding to acceleration along the X, Y, and Z axes. These outputs are routed to external filtering components to stabilize the signal.</p>
<div id="fig-ADXL335" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ADXL335-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ADXL335.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ADXL335-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: ADXL335 Block Diagram
</figcaption>
</figure>
</div>
</section>
<section id="ads1115-block-diagram" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="ads1115-block-diagram"><span class="header-section-number">4.1.2</span> ADS1115 Block Diagram</h3>
<p><a href="#fig-ADS1115" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> illustrates the functional block diagram of the ADS1115 Analog-to-Digital Converter. The ADC features a multiplexer (MUX) that allows for the selection between multiple input channels, followed by a programmable gain amplifier (PGA). The 16-bit delta-sigma ADC performs high-resolution conversion of the input signal. An internal voltage reference, oscillator, and I²C interface facilitate accurate conversion and communication with external devices. The comparator and ALERT/RDY functionality provide additional flexibility for system integration.</p>
<div id="fig-ADS1115" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ADS1115-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ADS1115.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ADS1115-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: ADS1115 Block Diagram
</figcaption>
</figure>
</div>
</section>
<section id="esp8266-pinout-diagram" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="esp8266-pinout-diagram"><span class="header-section-number">4.1.3</span> ESP8266 Pinout Diagram</h3>
<p>Finally, <a href="../elie4/index.html#fig-ESP8266" class="quarto-xref">Figure&nbsp;<span>7.5</span></a> displays the ESP8266 microcontroller module pinout. This microcontroller includes GPIO pins, I²C and SPI communication interfaces, and a built-in Wi-Fi module. The diagram highlights the various available digital interfaces for connecting to peripheral devices, as well as power and ground connections necessary for integration into the system. The ESP8266 is responsible for receiving the digital data from the ADS1115 and handling subsequent processing and wireless communication.</p>
<div id="fig-ESP8266" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ESP8266-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ESP8266.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ESP8266-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: ESP8266 Pinout Diagram
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="analog-to-digital-converter" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Analog-to-Digital Converter</h1>
<p>In an increasingly digitalized world, microprocessors and digital systems form the core of almost all modern control and communication systems. Whether in smartphones, industrial automation, or high-speed networks, digital processors handle central computing tasks and make real-time decisions. However, while processing occurs purely in the digital domain, the physical world remains analog. Sensors, actuators, and other external devices generate continuous analog signals that must first be converted into a discrete form for digital processing <span class="citation" data-cites="bajdechi2004systematic">(<a href="../elie4/index.html#ref-bajdechi2004systematic" role="doc-biblioref">Bajdechi 2004</a>)</span>.</p>
<p>This is where mixed-signal systems come into play, bridging the gap between the analog and digital domains. As the “brain” of nearly every control and communication system, the digital processor interacts with the external world through analog-to-digital converters (ADCs) for receiving analog signals and digital-to-analog converters (DACs) for sending analog outputs <span class="citation" data-cites="bajdechi2004systematic">(<a href="../elie4/index.html#ref-bajdechi2004systematic" role="doc-biblioref">Bajdechi 2004</a>)</span>.</p>
<p>As shown in <a href="#fig-adc-conversion" class="quarto-xref">Figure&nbsp;<span>5.1</span></a>, the general block diagram of an ADC designed for converting analog signals consists of an anti-aliasing filter (AAF), a sampler, and a quantizer <span class="citation" data-cites="delarosa2013">(<a href="../elie4/index.html#ref-delarosa2013" role="doc-biblioref">Rosa and Río 2013</a>)</span>.</p>
<div id="fig-adc-conversion" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-adc-conversion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/adc.drawio.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-adc-conversion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: A/D Conversion
</figcaption>
</figure>
</div>
<section id="sampling" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sampling"><span class="header-section-number">5.1</span> Sampling</h2>
<p>As shown, a set of key components is essential for converting an analog signal into a discrete-time representation. A fundamental aspect of this process is sampling, as it ensures the conversion of an analog signal into a discrete-time signal <span class="citation" data-cites="bajdechi2004systematic">(<a href="../elie4/index.html#ref-bajdechi2004systematic" role="doc-biblioref">Bajdechi 2004</a>)</span>.</p>
<p>In practical applications, sampling can occur in one of three modes. If the highest frequency present in the signal is limited to <span class="math inline">\(f_{\max}\)</span>, the sampling approaches are categorized as follows <span class="citation" data-cites="williams2006electronic">(<a href="../elie4/index.html#ref-williams2006electronic" role="doc-biblioref">Williams and Taylor 2006</a>)</span>:</p>
<ul>
<li>Critically sampled: <span class="math inline">\(f_s = 2 f_{\max},\)</span></li>
<li>Oversampled: <span class="math inline">\(f_s &gt; 2 f_{\max},\)</span></li>
<li>Undersampled: <span class="math inline">\(f_s &lt; 2 f_{\max}.\)</span></li>
</ul>
<p>Critical sampling refers to setting the sampling rate to the lowest possible value that still satisfies the sampling theorem. If this condition is not met, aliasing occurs, preventing accurate reconstruction of the input signal due to overlapping frequency components. To ensure that the highest frequency of the analog signal remains below the Nyquist frequency, an analog prefilter - known as an anti-aliasing filter - is typically placed between the signal source and the ADC. A well-designed anti-aliasing filter effectively attenuates signal energy above the Nyquist frequency. In practice, the input signal is often affected by noise, which may contain frequency components outside the desired range. Therefore, it is also essential that the filter removes out-of-band noise, as it could otherwise alias into the signal band after sampling and degrade the quality of the sampled values <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>. Undersampling can occur either deliberately or unintentionally. In both scenarios, the sampling rate is chosen to be lower than the Nyquist frequency. As a result, aliasing takes place <span class="citation" data-cites="williams2006electronic">(<a href="../elie4/index.html#ref-williams2006electronic" role="doc-biblioref">Williams and Taylor 2006</a>)</span>.</p>
<p>Furthermore, it is important to note that sampling results in a periodic repetition of the spectrum. The following example illustrates this:</p>
<!-- ![Periodic repetition of the spectrum](figures/periodic_spectrum.svg){#fig-Periodic-repetition-of-the-spectrum} -->
<div id="fig-Original-spectrum" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Original-spectrum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/spectrum.drawio.svg" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Original-spectrum-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Original spectrum
</figcaption>
</figure>
</div>
<div id="fig-spectrum-repetition" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spectrum-repetition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/periodic_repitition_spectrum.drawio.svg" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spectrum-repetition-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Periodic repetition of the spectrum
</figcaption>
</figure>
</div>
<p>If the conditions of the sampling theorem are met, the input signal can be fully reconstructed by filtering with an ideal low-pass filter with a cutoff frequency <span class="math inline">\({{\omega_g}}\)</span> and an amplitude of <span class="math inline">\({{T_a}}\)</span> <span class="citation" data-cites="goldenbaum2022grundlagen">(<a href="../elie4/index.html#ref-goldenbaum2022grundlagen" role="doc-biblioref">Goldenbaum 2022</a>)</span>:</p>
<p><span class="math display">\[
H_{AAF}(\omega) = T_a \, \operatorname{rect}(\omega / 2\omega_g). \tag{1}
\]</span></p>
<div id="fig-Reconstruction-by-filtering-with-a-low-pass-filter" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Reconstruction-by-filtering-with-a-low-pass-filter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ideal_fitler.drawio.svg" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Reconstruction-by-filtering-with-a-low-pass-filter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Reconstruction by filtering with a low-pass filter
</figcaption>
</figure>
</div>
<p>In the frequency domain, an ideal low-pass filter with a specific cutoff frequency is used to fully reconstruct the signal. Since this corresponds to a multiplication with a rectangular function in the frequency domain, it results in a convolution with the sinc function in the time domain. The sinc interpolation is a series expansion in which the maxima of the individual sinc functions coincide with the sampled values. Each sample point is associated with a corresponding sinc function. Consequently, the original function can be reconstructed as a weighted sum of sinc functions, where each sample value corresponds to a sinc function shifted by the sampling period <span class="math inline">\(T_a\)</span>. The superposition of these sinc functions then reconstructs the original function <span class="citation" data-cites="meyer2019kommunikationstechnik">(<a href="../elie4/index.html#ref-meyer2019kommunikationstechnik" role="doc-biblioref">Meyer 2019</a>)</span>.</p>
<div id="fig-Reconstruction-of-a-sampled-signal-using-sinc-interpolation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Reconstruction-of-a-sampled-signal-using-sinc-interpolation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/sinc_interpolation.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Reconstruction-of-a-sampled-signal-using-sinc-interpolation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Example of a reconstruction of a sampled signal using sinc interpolation
</figcaption>
</figure>
</div>
</section>
<section id="quantization" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="quantization"><span class="header-section-number">5.2</span> Quantization</h2>
<p>Quantization is a nonlinear, memoryless operation <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>. It refers to the conversion of a continuous-valued signal into a signal with a finite set of values <span class="citation" data-cites="goldenbaum2022grundlagen">(<a href="../elie4/index.html#ref-goldenbaum2022grundlagen" role="doc-biblioref">Goldenbaum 2022</a>)</span>. Unlike the sampling process, quantization is an irreversible operation, leading to a loss in the resolution of the digitized signal <span class="citation" data-cites="delarosa2011sigmadelta">(<a href="../elie4/index.html#ref-delarosa2011sigmadelta" role="doc-biblioref">Rosa 2011</a>)</span>.</p>
<p>The quantization operator is typically described by a quantization characteristic:</p>
<div id="fig-Quantization-characteristic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Quantization-characteristic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/quantization_characteristic-Seite-2.drawio.svg" class="img-fluid figure-img" style="width:62.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Quantization-characteristic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: Quantization characteristic <span class="citation" data-cites="goldenbaum2022grundlagen">(<a href="../elie4/index.html#ref-goldenbaum2022grundlagen" role="doc-biblioref">Goldenbaum 2022</a>)</span>
</figcaption>
</figure>
</div>
<p>The quantization level <strong><span class="math inline">\(Q\)</span></strong> defines the respective quantization intervals. These intervals are determined by the word length <strong><span class="math inline">\(q\)</span></strong> (also referred to as the bit width). The relationship is given by <strong><span class="math inline">\(Q = 2^q\)</span></strong>. The greater the word length, the more quantization intervals exist. This means that the quantization becomes more precise, as the difference between the actual value and the quantized value continuously decreases <span class="citation" data-cites="goldenbaum2022grundlagen">(<a href="../elie4/index.html#ref-goldenbaum2022grundlagen" role="doc-biblioref">Goldenbaum 2022</a>)</span>.</p>
<p>The delta (<strong><span class="math inline">\(\Delta\)</span></strong>) represents the accuracy and is defined as <strong><span class="math inline">\(\Delta = 2/Q\)</span></strong>. This implies that as <strong><span class="math inline">\(Q\)</span></strong> increases, the word length <strong><span class="math inline">\(q\)</span></strong> also grows, and <strong><span class="math inline">\(\Delta\)</span></strong> becomes smaller. Since the step size between quantization levels decreases, the resolution improves <span class="citation" data-cites="goldenbaum2022grundlagen">(<a href="../elie4/index.html#ref-goldenbaum2022grundlagen" role="doc-biblioref">Goldenbaum 2022</a>)</span>. After quantization, digital signals are generated. Each quantization interval is assigned a unique code number.</p>
<p>The quantization process also imposes a limitation on the performance of an ideal ADC, as an error is introduced during the conversion of the input signal from a continuous to a discrete amplitude representation. This error, commonly known as quantization error, will be discussed in more detail in a later chapter.</p>
</section>
</section>
<section id="delta-sigma-adcs" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Delta-Sigma ADCs</h1>
<p>The general block diagram of a Delta-Sigma ADC is as follows:</p>
<div id="fig-General-block-diagram-of-a-Delta-sigma-ADC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-General-block-diagram-of-a-Delta-sigma-ADC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/General_block_diagram.drawio.svg" class="img-fluid figure-img" style="width:105.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-General-block-diagram-of-a-Delta-sigma-ADC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: General block diagram of a Delta-sigma ADC
</figcaption>
</figure>
</div>
<p>The topology includes an antialiasing filter, which band-limits the analog input signal to prevent aliasing during subsequent sampling. In this case, the sampling is oversampling and significantly reduces the attenuation requirements of the AAF, allowing for smoother transition bands compared to Nyquist-rate ADCs. The central block, the Delta-Sigma modulator, performs oversampling and quantization of the band-limited analog signal. The quantization noise is shaped in the frequency domain by introducing an appropriate loop filter <span class="math inline">\(H(z)\)</span> and enclosing it within a negative feedback loop. The decimation filter applies a highly selective digital filter to sharply remove out-of-band spectral components from the delta-sigma output, effectively eliminating most of the shaped quantization noise. Additionally, the decimator reduces the data rate from <span class="math inline">\(f_s\)</span> down to the Nyquist frequency while increasing the word length <span class="citation" data-cites="delarosa2013">(<a href="../elie4/index.html#ref-delarosa2013" role="doc-biblioref">Rosa and Río 2013</a>)</span>.</p>
<section id="system-outline" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="system-outline"><span class="header-section-number">6.1</span> System Outline</h2>
<!-- ![System overview](figures/System_overview.drawio.svg){#fig-Sysem-overview width=85%} -->
<p>A <span class="math inline">\(\Delta\Sigma\)</span> converter operates as a 1-bit sampling system, where an analog input signal is sampled multiple times through oversampling. At its core, the <span class="math inline">\(\Delta\Sigma\)</span> modulator converts the analog signal into a high-speed, single-bit pulse stream while shaping the quantization noise. The modulator can be analyzed in both the time domain and frequency domain.</p>
<div id="fig-first_order_delta_sigma_modulator_time_domain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-first_order_delta_sigma_modulator_time_domain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/first_order_time_domain.drawio.svg" class="img-fluid figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-first_order_delta_sigma_modulator_time_domain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: First-order <span class="math inline">\(\Delta\Sigma\)</span> modulator in the time domain <span class="citation" data-cites="baker2011delta">(<a href="../elie4/index.html#ref-baker2011delta" role="doc-biblioref">Baker 2011</a>)</span>
</figcaption>
</figure>
</div>
<p><a href="#fig-first_order_delta_sigma_modulator_time_domain" class="quarto-xref">Figure&nbsp;<span>6.2</span></a> depicts the time-domain representation of the modulator. It consists of a difference amplifier, an integrator, and a comparator, with a feedback loop incorporating a 1-bit DAC.</p>
<p>The system continuously calculates the difference between the input signal and a feedback signal, emphasizing changes rather than absolute values. This difference signal is then integrated, influencing the output direction. When the integrator output reaches the comparator threshold, the 1-bit ADC quantizes it into a binary value. The output is fed back through a 1-bit DAC, creating a closed-loop system that shapes the noise and stabilizes the signal. The resulting pulse waveform represents the input signal, and when averaged over time, it approximates the original analog input <span class="citation" data-cites="baker2011delta">(<a href="../elie4/index.html#ref-baker2011delta" role="doc-biblioref">Baker 2011</a>)</span>. The DAC functions as a simple switch that connects the negative input of the difference amplifier to either a positive or negative reference voltage. Its primary role is to keep the integrator’s average output near the comparator’s reference level <span class="citation" data-cites="integrated2003demystifying">(<a href="../elie4/index.html#ref-integrated2003demystifying" role="doc-biblioref">Maxim 2003</a>)</span>.</p>
<div id="fig-first_order_delta_sigma_modulator_frequency_domain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-first_order_delta_sigma_modulator_frequency_domain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/first_order_freq_domain1.drawio.svg" class="img-fluid figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-first_order_delta_sigma_modulator_frequency_domain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: First-order <span class="math inline">\(\Delta\Sigma\)</span> modulator in the frequency domain
</figcaption>
</figure>
</div>
<p><a href="#fig-first_order_delta_sigma_modulator_frequency_domain" class="quarto-xref">Figure&nbsp;<span>6.3</span></a> shows the frequency-domain representation. In this domain, the combination of integration and oversampling functions as a noise-shaping filter, enabling high-resolution conversion by pushing noise outside the signal band. Thanks to these characteristics, <span class="math inline">\(\Delta\Sigma\)</span> ADCs are widely used in applications requiring high accuracy, such as audio processing, sensor technology, and precision measurements .</p>
<div class="callout callout-style-default callout-note callout-titled" title="Why is it called Delta-Sigma?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why is it called Delta-Sigma?
</div>
</div>
<div class="callout-body-container callout-body">
<p>The name <strong>Delta-Sigma</strong> originates from the key mathematical operations performed in the modulator.</p>
<ul>
<li><strong>Delta (Δ)</strong> represents the difference operation. The system continuously calculates the difference between the input signal and the feedback signal, ensuring that it tracks changes rather than absolute values. This differentiation process helps in shaping the quantization noise.<br>
</li>
<li><strong>Sigma (Σ)</strong> refers to accumulation (or integration). After computing the difference, the error signal is integrated over time, effectively summing past values. This process shapes the noise spectrum, reducing in-band noise while pushing most of it to higher frequencies.</li>
</ul>
<p>Some sources use the term <strong>Sigma-Delta</strong> instead of <strong>Delta-Sigma</strong>, emphasizing the integration first. However, both terms describe the same modulation technique.</p>
</div>
</div>
</section>
<section id="fundamental-concepts" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="fundamental-concepts"><span class="header-section-number">6.2</span> Fundamental Concepts</h2>
<div id="fig-Fundamental-concepts-of-the-Delta-Sigma-ADC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Fundamental-concepts-of-the-Delta-Sigma-ADC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/concepts_delta_sigma_adc.drawio.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Fundamental-concepts-of-the-Delta-Sigma-ADC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Fundamental concepts of the <span class="math inline">\(\Delta\Sigma\)</span> ADC
</figcaption>
</figure>
</div>
<p>A <span class="math inline">\(\Delta\Sigma\)</span> ADC leverages advanced signal processing techniques to achieve higher resolution than conventional ADCs. Oversampling increases the sampling rate beyond the Nyquist frequency, spreading quantization noise over a wider frequency range. Noise shaping further pushes this noise into higher frequencies, where it can be effectively removed by digital filtering. Finally, decimation reduces the sample rate while preserving the signal’s integrity, resulting in a high-precision digital output.</p>
</section>
<section id="oversampling" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="oversampling"><span class="header-section-number">6.3</span> Oversampling</h2>
<p>If an ADC operates faster than <span class="math inline">\(2f_{\text{max}}\)</span>, it is considered an oversampled ADC. In this case, the <strong>oversampling ratio (OSR)</strong> is a design parameter that indicates how many times <span class="math inline">\(f_s\)</span> is larger than the minimal value required by the Nyquist theorem.</p>
<p><span class="math display">\[
OSR = \frac{f_s}{2 f_{\text{max}}}, \tag{2}
\]</span></p>
<p>where <span class="math inline">\(f_{\text{max}}\)</span> is the maximum signal frequency, which is the signal bandwidth <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>.</p>
<p>Oversampled ADCs impose significantly less stringent requirements on the filter compared to Nyquist rate converters, as the signal is sampled at a frequency that far exceeds its bandwidth <span class="citation" data-cites="Boser1988">(<a href="../elie4/index.html#ref-Boser1988" role="doc-biblioref">Boser and Wooley 1988</a>)</span>. One advantage of oversampling ADCs is that they simplify the requirements for the AAF, as can be seen in <a href="#fig-Antialiasing-filter-for-oversampling-ADCs" class="quarto-xref">Figure&nbsp;<span>6.5</span></a>. It is important to note that the AAF for a Nyquist converter must have a sharp transition band, which often results in phase distortion for signal components near the cut-off frequency <span class="citation" data-cites="delarosa2011sigmadelta">(<a href="../elie4/index.html#ref-delarosa2011sigmadelta" role="doc-biblioref">Rosa 2011</a>)</span>, as can be seen in <a href="#fig-Reconstruction-by-filtering-with-a-low-pass-filter" class="quarto-xref">Figure&nbsp;<span>5.4</span></a>.</p>
<div id="fig-Antialiasing-filter-for-oversampling-ADCs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Antialiasing-filter-for-oversampling-ADCs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/oversampled_spectrum.drawio.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Antialiasing-filter-for-oversampling-ADCs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: Antialiasing filter for oversampling ADCs
</figcaption>
</figure>
</div>
<p>However, oversampling has another effect that must be considered: noise. This phenomenon, known as quantization noise, arises for the following reason: while the ADC input is a continuous signal with an infinite range of possible values, the digital output is discrete, with the number of distinct states determined by the converter’s resolution. As a result, the analog-to-digital conversion process inevitably discards some information, introducing a certain degree of distortion into the signal. The associated error varies randomly, with a magnitude of up to ±1 LSB <span class="citation" data-cites="Clifford2016">(<a href="../elie4/index.html#ref-Clifford2016" role="doc-biblioref">Clifford 2016</a>)</span>. <a href="#fig-Quantization-noise-in-Nyquist-rate-ADCs" class="quarto-xref">Figure&nbsp;<span>6.9</span></a> shows the signal with quantization noise:</p>
<div id="fig-Quantization-noise-in-Nyquist-rate-ADCs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Quantization-noise-in-Nyquist-rate-ADCs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/spectrum_repetition.drawio.svg" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Quantization-noise-in-Nyquist-rate-ADCs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: Quantization noise in Nyquist-rate ADCs
</figcaption>
</figure>
</div>
<p>In practice, an ideal quantizer is often described using a linear model, provided that certain assumptions about the statistical properties of the quantization error hold. The quantization error <span class="math inline">\(e(n)\)</span> is directly dependent on the quantizer input signal <span class="math inline">\(q(n)\)</span>, as shown in <a href="#fig-Multi-bit-quantization-error" class="quarto-xref">Figure&nbsp;<span>6.7</span></a>.</p>
<div id="fig-Multi-bit-quantization-error" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Multi-bit-quantization-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Multi_bit_quantization.drawio.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Multi-bit-quantization-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: Multi-bit quantization error
</figcaption>
</figure>
</div>
<p>If <span class="math inline">\(q(n)\)</span> is considered to vary randomly from sample to sample within the interval <span class="math inline">\([-\Delta/2, +\Delta/2]\)</span>, the quantization error <span class="math inline">\(e(n)\)</span> will also be uncorrelated between successive samples. Under these assumptions, the quantization error can be represented as a random process following a uniform probability distribution within the range <span class="math inline">\([-\Delta/2, +\Delta/2]\)</span>, as shown in <a href="#fig-Probability-density-function" class="quarto-xref">Figure&nbsp;<span>6.8</span></a>.</p>
<div id="fig-Probability-density-function" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Probability-density-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/PDF.drawio.svg" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Probability-density-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.8: Probability density function (PDF) of the quantization error assuming a uniform distribution
</figcaption>
</figure>
</div>
<p>As can be seen, quantization noise exhibits characteristics similar to white noise in the frequency domain, maintaining a constant power spectral density across the entire frequency range. The power associated with the quantization error can thus be computed as <span class="citation" data-cites="delarosa2013">(<a href="../elie4/index.html#ref-delarosa2013" role="doc-biblioref">Rosa and Río 2013</a>)</span>:</p>
<p><span class="math display">\[
\overline{e^2} = \sigma_e^2 = \int_{-\infty}^{\infty} e^2 \, \text{PDF}(e) \, de = \frac{1}{\Delta} \int_{-\Delta/2}^{+\Delta/2} e^2 \, de = \frac{\Delta^2}{12}. \tag{3}
\]</span></p>
<p>The former assumption implies that the power of the quantization error will also be uniformly distributed in the range <span class="math inline">\([-f_s/2, +f_s/2]\)</span>, yielding <span class="citation" data-cites="delarosa2013">(<a href="../elie4/index.html#ref-delarosa2013" role="doc-biblioref">Rosa and Río 2013</a>)</span>:</p>
<p><span class="math display">\[
\overline{e^2} = \int_{-\infty}^{\infty} S_E(f) \, df = S_E \int_{-f_s/2}^{+f_s/2} df = \frac{\Delta^2}{12}, \tag{4}
\]</span></p>
<p>so that the PSD of the quantization error in this range is:</p>
<p><span class="math display">\[
S_E = \frac{\overline{e^2}}{f_s} = \frac{\Delta^2}{12 f_s}.\tag{5}
\]</span></p>
<p>These assumptions are referred to as the additive white noise approximation of the quantization error. They allow a quantizer, which is inherently deterministic and nonlinear, to be represented using a random linear model. This model is expressed as <span class="citation" data-cites="delarosa2013">(<a href="../elie4/index.html#ref-delarosa2013" role="doc-biblioref">Rosa and Río 2013</a>)</span>:</p>
<p><span class="math display">\[
y(n) = k_q(n) + e(n) \tag{6} ,
\]</span></p>
<p>where <span class="math inline">\(e(n)\)</span> represents the quantization noise.</p>
<p>Using this approximation of quantization error as white noise, the performance of ideal ADCs can be easily evaluated. In a Nyquist ADC, where <span class="math inline">\(f_s = 2 f_{\text{max}}\)</span>, all the quantization noise power remains within the signal band and appears at the ADC output as part of the input signal itself, as illustrated in <a href="#fig-Quantization-noise-in-Nyquist-rate-ADCs" class="quarto-xref">Figure&nbsp;<span>6.9</span></a>.</p>
<p>Conversely, if an oversampled signal is quantized, only a fraction of the total quantization noise power lies within the signal band, as illustrated in <a href="#fig-Quantization-noise-in-Nyquist-rate-ADCs" class="quarto-xref">Figure&nbsp;<span>6.9</span></a>:</p>
<div id="fig-Quantization-noise-in-Nyquist-rate-ADCs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Quantization-noise-in-Nyquist-rate-ADCs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/oversampled_spectrum_noise.drawio.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Quantization-noise-in-Nyquist-rate-ADCs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.9: Quantization noise in oversampling ADCs
</figcaption>
</figure>
</div>
<p>While the SNR remains unchanged, the noise energy is now distributed across a broader frequency range <span class="citation" data-cites="integrated2003demystifying">(<a href="../elie4/index.html#ref-integrated2003demystifying" role="doc-biblioref">Maxim 2003</a>)</span>. The in-band noise power (IBN) caused by the quantization process in an ideal oversampling ADC is thus <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>:</p>
<p><span class="math display">\[
\text{IBN} = \int_{-f_{\text{max}}}^{+f_{\text{max}}} S_E(f) \, df = \int_{-f_{\text{max}}}^{+f_{\text{max}}} \frac{\Delta^2}{12 f_s} \, df = \frac{\Delta^2}{12 \text{OSR}} \tag{7},
\]</span> where <span class="math inline">\(S_E(f)\)</span> is the quantization error power spectral density, <span class="math inline">\(\Delta\)</span> is the quantization resolution, <span class="math inline">\(f_s\)</span> is the sampling frequency, and OSR represents the oversampling ratio <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>.</p>
<p>Note that the SNR for a 1-bit ADC is 7.78 dB (6.02 + 1.76). Each factor-of-4 oversampling increases the SNR by 6 dB, and every 6 dB increase corresponds to gaining one additional bit of resolution. A 1-bit ADC with 24× oversampling can achieve a resolution of four bits. However, achieving 14-bit resolution would require oversampling by a factor of <span class="math inline">\(4^{15}\)</span>, which is impractical <span class="citation" data-cites="integrated2003demystifying">(<a href="../elie4/index.html#ref-integrated2003demystifying" role="doc-biblioref">Maxim 2003</a>)</span>.</p>
<p><span class="math inline">\(\Delta\Sigma\)</span> converters address this limitation through noise shaping, a technique that enables a gain of more than 6 dB per factor-of-4 oversampling <span class="citation" data-cites="integrated2003demystifying">(<a href="../elie4/index.html#ref-integrated2003demystifying" role="doc-biblioref">Maxim 2003</a>)</span>.</p>
</section>
<section id="noise-shaping" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="noise-shaping"><span class="header-section-number">6.4</span> Noise shaping</h2>
<p>To further improve the conversion resolution at the same sampling frequency <span class="math inline">\(f_s\)</span> and with the same number of ADC bits, noise shaping can be applied. This is accomplished by high-pass filtering the quantization noise to displace most of its power from low frequencies, where the input signal spectrum resides, to higher frequencies near <span class="math inline">\(f_s/2\)</span> <span class="citation" data-cites="bajdechi2004systematic">(<a href="../elie4/index.html#ref-bajdechi2004systematic" role="doc-biblioref">Bajdechi 2004</a>)</span>, ensuring that most of its power is moved outside the signal band <span class="citation" data-cites="delarosa2013">(<a href="../elie4/index.html#ref-delarosa2013" role="doc-biblioref">Rosa and Río 2013</a>)</span>.</p>
<p>To understand noise shaping, the system can be analyzed from different perspectives. Starting with <a href="#fig-first_order_delta_sigma_modulator_time_domain" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>, the 1-bit DAC in the feedback loop can be observed. The primary role of the feedback DAC is to keep the integrator’s average output near the comparator’s reference level. The density of ones at the modulator output is proportional to the input signal. As the input increases, the comparator generates a higher number of ones, and conversely, for a decreasing input, fewer ones are produced. By summing the error voltage, the integrator acts as a low-pass filter for the input signal and a high-pass filter for the quantization noise. As a result, most of the quantization noise is shifted to higher frequencies <span class="citation" data-cites="integrated2003demystifying">(<a href="../elie4/index.html#ref-integrated2003demystifying" role="doc-biblioref">Maxim 2003</a>)</span>.</p>
<p>Another way to analyze the system, especially with regard to noise shaping, is by using linear models.</p>
<section id="linear-model" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="linear-model"><span class="header-section-number">6.4.1</span> Linear Model</h3>
<p><a href="#fig-Ideal-linear-model" class="quarto-xref">Figure&nbsp;<span>6.10</span></a> illustrates an idealized linear model of a delta-sigma modulator, represented as a negative feedback system. <span class="math inline">\(x\)</span> represents the discrete-time input signal to the system, <span class="math inline">\(y\)</span> is the system’s output signal and <span class="math inline">\(k_q\)</span> refers to the gain factor of the quantization error and can be chosen arbitrarily in the case of a 1-bit quantizer. The model aims to improve the understanding that the goal is to have a frequency-dependent gain. This gain should be infinite at low frequencies so that the noise transfer function (NTF) has a small magnitude at low frequencies. The lowest-order system with these characteristics is an integrator. <span class="math inline">\(\frac{1}{1 - z^{-1}}\)</span> represents the discrete-time integrator. It accumulates the error signal over time and is a key element in shaping the noise spectrum. <span class="math inline">\(z^{-1}\)</span> is a unit delay element, which models the feedback delay in the loop <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>.</p>
<div id="fig-Ideal-linear-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ideal-linear-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Linear_model.drawio.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ideal-linear-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.10: Ideal linear model
</figcaption>
</figure>
</div>
<p>At the heart of the model is the loop filter, a fundamental component that shapes the spectral characteristics of the quantization noise. Functionally, it acts as a discrete-time integrator, enabling past sample values to influence the current output. This feedback mechanism is essential for achieving noise shaping, as it suppresses in-band noise while pushing the quantization error toward higher frequencies, where it can be more easily filtered.</p>
<p>The following equation shows the relationship between the system’s input, quantization error, and output:</p>
<p><span class="math display">\[
Y(z) = z^{-1} X(z) + (1 - z^{-1}) E(z).\tag{8}
\]</span></p>
<p>It illustrates that the output <span class="math inline">\(Y(z)\)</span> consists of the delayed input signal <span class="math inline">\(X(z)\)</span> and the shaped quantization error. Here, <span class="math inline">\(z^{-1}\)</span> represents the signal transfer function (STF), while the noise transfer function (NTF), <span class="math inline">\((1 - z^{-1})\)</span>, exhibits a first-order high-pass characteristic with a transmission zero at DC (<span class="math inline">\(\omega = 0\)</span>, i.e., <span class="math inline">\(z = e^{j\omega} = 1\)</span>), since <span class="math inline">\(1 - e^{-j0} = 0\)</span>.</p>
<p>The logarithmic plot of the magnitude response of the NTF in log scale shows the first-order nature of the high-pass response, increasing at a rate of 20 dB per decade <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>.</p>
<p>The in-band noise power decreases proportionally to <span class="math inline">\(OSR^{-3}\)</span>.</p>
<p><span class="math display">\[
\text{IBN} = \frac{\Delta^2}{24\pi} \int_{-\frac{\pi}{OSR}}^{\frac{\pi}{OSR}} |(1 - e^{-j\omega})|^2 d\omega
= \frac{\Delta^2}{12\pi} \int_{0}^{\frac{\pi}{OSR}} 4 \sin^2\left(\frac{\omega}{2}\right) d\omega
\]</span></p>
<p><span class="math display">\[
\approx \frac{\Delta^2}{12\pi} \int_{0}^{\frac{\pi}{OSR}} \omega^2 d\omega
= \frac{\Delta^2}{36\pi} \frac{\pi^3}{OSR^3}.
\]</span></p>
<p>When the oversampling ratio is doubled, the in-band noise power reduces by 9 dB, which results in an effective resolution improvement of 1.5 bits. In contrast, basic oversampling without noise shaping only increases resolution by 0.5 bits for each doubling of the OSR. In principle, achieving high accuracy is possible by selecting a sufficiently large <span class="math inline">\(OSR\)</span>. However, combining oversampling with noise shaping significantly reduces the required OSR value.</p>
<!--
![Single chain with first-order Delta-Sigma loop](figures/11Mod.drawio.svg){#fig-Single-chain-with-first-order-Delta-Sigma-loop width=80%}

The system diagram of a first-order Sigma-Delta converter is illustrated in @fig-Single-chain-with-first-order-Delta-Sigma-loop. The output consists of the input signal $x$ combined with the quantization error, defined as $e = y - x$. Consequently, 

$$
Y(z) = z^{-1} X(z) + (1 - z^{-1}) E(z). \tag{8}
$$

The quantization error is attenuated in the signal band through first-order noise shaping, characterized by the transfer function $(1 - z^{-1})$, which has a zero at DC [@pavan2017understanding].
-->
</section>
</section>
<section id="second-order-delta-sigma-modulation" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="second-order-delta-sigma-modulation"><span class="header-section-number">6.5</span> Second-Order Delta-Sigma Modulation</h2>
<p>Following oversampling and noise shaping, the question arises as to how quantization noise can be further reduced. A modulator that integrates the input signal twice instead of just once is an effective way for that. <a href="#fig-second-order-delta-sigma-modulator" class="quarto-xref">Figure&nbsp;<span>6.11</span></a> illustrates a 1-bit, second-order modulator that uses two integrators instead of one. In this case, the noise term depends not only on the previous error but also on the two preceding errors.</p>
<div id="fig-second-order-delta-sigma-modulator" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-second-order-delta-sigma-modulator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/22Mod.drawio.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-second-order-delta-sigma-modulator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.11: Second-order <span class="math inline">\(\Delta\Sigma\)</span> modulator
</figcaption>
</figure>
</div>
<p>Increasing the resolution and the effective number of bits (ENOB) in a <span class="math inline">\(\Delta\Sigma\)</span> modulator can be achieved by incorporating an additional integrator and feedback path. A linearized analysis in this scenario leads to the expression:</p>
<p><span class="math display">\[
Y(z) = z^{-1} X(z) + (1 - z^{-1})^2E(z). \tag{9}
\]</span></p>
<p>This shows that the NTF takes the form <span class="math inline">\((1 - z^{-1})^2\)</span> in the z-domain, applying a shaping function of <span class="math inline">\((2 \sin(\omega/2))^4\)</span> to the PSD. As a result, doubling the OSR leads to an increase of approximately 2.5 bits in resolution. This represents a significantly better trade-off compared to a first-order modulator.</p>
<p>By incorporating more integrators and feedback branches within the loop, it is possible to achieve higher-order noise transfer functions. In the case of an L-th order loop filter, the NTF follows the form:</p>
<p><span class="math display">\[
NTF(z) = (1 - z^{-1})^L. \tag{10}
\]</span></p>
<p>Under these conditions, the in-band noise power is given by:</p>
<p><span class="math display">\[
IBN = \frac{\pi^{2L} e^2_{rms}}{(2L + 1) OSR^{2L+1}}. \tag{11}
\]</span></p>
<div class="callout callout-style-default callout-important callout-titled" title="The Trade-Offs of High-Order $\Delta\Sigma$ Modulators">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Trade-Offs of High-Order <span class="math inline">\(\Delta\Sigma\)</span> Modulators
</div>
</div>
<div class="callout-body-container callout-body">
<p>The previous discussion suggests that a <span class="math inline">\(\Delta\Sigma\)</span> loop with a carefully chosen, very high-order NTF could, in theory, achieve exceptionally high performance. However, if something sounds too good to be true, it probably is. In practice, high-order loops introduce stability challenges. These limitations reduce the achievable resolution to a lower value than the theoretical predictions.</p>
<p>Moreover, second- and higher-order modulators come with additional drawbacks, including increased complexity, multiple feedback loops, and greater design difficulty.</p>
</div>
</div>
</section>
<section id="decimation" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="decimation"><span class="header-section-number">6.6</span> Decimation</h2>
<p>After the <span class="math inline">\(\Delta\Sigma\)</span> modulator, the decimator follows, which is shown as the final stage in <a href="#fig-General-block-diagram-of-a-Delta-sigma-ADC" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>. The undesirable characteristics of the modulator output include high-frequency noise and a high-speed, 1-bit output rate. Once the signal is in the digital domain, a low-pass digital filter can be applied to attenuate the high-frequency noise, while a down-sampler can be used to reduce the output data rate <span class="citation" data-cites="baker2011delta">(<a href="../elie4/index.html#ref-baker2011delta" role="doc-biblioref">Baker 2011</a>)</span>.</p>
<p>A down-sampler with a downsampling factor <span class="math inline">\(M\)</span>, where <span class="math inline">\(M\)</span> is a positive integer, produces an output sequence with a sampling rate that is <span class="math inline">\({1}/{M}\)</span> of the input sequence’s sampling rate. It retains every <span class="math inline">\(M\)</span>-th sample of the input sequence and discards the <span class="math inline">\(M - 1\)</span> intermediate samples to generate the output. By removing samples, down-sampling increases the sampling period. If the input sampling rate is defined as <span class="math inline">\(F_T = {1}/{T}\)</span>, then the output sampling rate <span class="math inline">\(F_M\)</span> is related to <span class="math inline">\(F_T\)</span> as follows <span class="citation" data-cites="wolter2023dsp2">(<a href="../elie4/index.html#ref-wolter2023dsp2" role="doc-biblioref">Wolter 2023</a>)</span>:</p>
<p><span class="math display">\[
F_M = \frac{1}{T_M} = \frac{1}{M T} = \frac{F_T}{M}. \tag{12}
\]</span></p>
<p>This means that after down-sampling, the new sampling frequency is a fraction of the original rate. It is also important to examine the frequency-domain relation of a down-sampler. The relationship between input and output in the z-transform domain can be analyzed by the following relation:</p>
<p><span class="math display">\[
Y(z) = \frac{1}{M} \sum_{k=0}^{M-1} X\left(z^{1/M} W_M^k\right). \tag{13}
\]</span></p>
<p>This equation shows that the output spectrum consists of a sum of <span class="math inline">\(M\)</span> stretched and shifted copies of the input spectrum, scaled by a factor of <span class="math inline">\(1/M\)</span>.</p>
<p>The output spectrum of a down-sampler with a factor of <span class="math inline">\(M\)</span> is given by:</p>
<p><span class="math display">\[
Y(e^{j\omega}) = \frac{1}{M} \sum_{k=0}^{M-1} X\left(e^{j(\omega - 2\pi k)/M}\right). \tag{14}
\]</span></p>
<p>Aliasing in <span class="math inline">\(Y(e^{j\omega})\)</span> is completely avoided if and only if:</p>
<p><span class="math display">\[
X(e^{j\omega}) = 0 \quad \text{for} \quad {\pi}/{M} \leq |\omega| \leq \pi . \tag{15}
\]</span></p>
<p>This means that <span class="math inline">\(x[n]\)</span> must be band-limited to <span class="math inline">\(\pm \pi / M\)</span> <span class="citation" data-cites="wolter2023dsp2">(<a href="../elie4/index.html#ref-wolter2023dsp2" role="doc-biblioref">Wolter 2023</a>)</span>.</p>
<p>In multistage signal processing systems, the order of <strong>downsampling and filtering</strong> can be interchanged under certain conditions. This is particularly useful as it allows for computational efficiency in systems with variable sampling rates. A signal <span class="math inline">\(x[n]\)</span> is first downsampled by a factor of <span class="math inline">\(M\)</span> and then processed by the filter <span class="math inline">\(H(z)\)</span>:</p>
<div id="fig-Multirate-Identitaet1-Downsampling-before-filtering" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Multirate-Identitaet1-Downsampling-before-filtering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/MultirateIdentity.drawio.svg" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Multirate-Identitaet1-Downsampling-before-filtering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.12: Multirate Idenetity: Downsampling before filtering
</figcaption>
</figure>
</div>
<p>The corresponding representation in the Z-domain is:</p>
<p><span class="math display">\[
Y_1(z) = H(z) \frac{1}{M} \sum_{k=0}^{M-1} X\left(z^{1/M} W_M^k\right).
\]</span></p>
<p>The order of filtering and downsampling can be interchanged if the original filter <span class="math inline">\(H(z)\)</span> is replaced with <span class="math inline">\(H(z^M)\)</span>:</p>
<div id="fig-Multirate-Identitawt:-Filtering-before-downsampling" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Multirate-Identitawt:-Filtering-before-downsampling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/MultirateIdentity2.drawio.svg" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Multirate-Identitawt:-Filtering-before-downsampling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.13: Multirate Idenetity: Filtering before downsampling
</figcaption>
</figure>
</div>
<p>This equivalence allows for flexibility in system design.</p>
<p>The down-sampler retains only every <span class="math inline">\(M\)</span>-th sample. Consequently, it is sufficient to compute only for values that are multiples of <span class="math inline">\(M\)</span>, while skipping the computations of the intermediate samples. This results in a computational complexity reduction by a factor of <span class="math inline">\(M\)</span>. The decimation filter can be implemented as either an FIR or an IIR filter. Since the output is being downsampled, it is sufficient to compute only for values of <span class="math inline">\(n\)</span> that are integer multiples of <span class="math inline">\(M\)</span>. However, the feedback signal must still be computed for all values of <span class="math inline">\(n\)</span>. As a result, in such cases, the computational savings are always less than <span class="math inline">\(M\)</span>. Therefore, FIR filters are often preferred in multirate systems due to their advantages in stability and implementation efficiency.</p>
<section id="two-stage-decimator-structure" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="two-stage-decimator-structure"><span class="header-section-number">6.6.1</span> Two-Stage Decimator Structure</h3>
<p>As previously mentioned, interchanging the positions of individual branches in such a cascade can often lead to a more computationally efficient implementation. The basic building blocks for altering the sampling rate only allow for an integer factor change in the sampling rate of a signal. To achieve a fractional (rational) change in the sampling rate, a cascade consisting of a downsampler with factor <span class="math inline">\(M\)</span> and an upsampler with factor <span class="math inline">\(L\)</span> must be used. These rules allow us to reposition the fundamental sampling rate conversion devices within multirate networks to more favorable locations. They prove to be extremely useful in the design and analysis of more complex systems <span class="citation" data-cites="mitra2001digital">(<a href="../elie4/index.html#ref-mitra2001digital" role="doc-biblioref">Mitra 2001</a>)</span>.</p>
<!--
The specifications for the lowpass decimation filter can be developed as follows:

$$
|H(e^{j\omega})| =
\begin{cases}
1, & |\omega| \le \frac{\omega_p}{M},\\
0, & \frac{\pi}{M} \le |\omega| \le \pi
\end{cases}
$$

where $\omega_c$ denotes the highest frequency that needs to be preserved in the decimated signal.
-->
<!--The lowpass decimation filter may be implemented using either an FIR or an IIR digital filter. In typical single-rate digital signal processing scenarios, IIR filters tend to be the more computationally efficient choice compared to FIR filters. As a result, they are often selected when reducing computational complexity is a key consideration.-->
<p>For the decimation filter the computational savings can be achieved, especially with FIR filters. With IIR filters, the simplification is only partially applicable. While only every <span class="math inline">\(M\)</span>-th output is used, the internal recursive nature of the filter requires the computation of all intermediate values. This limits the potential efficiency gain. However, IIR filters can still be more efficient overall due to their typically lower required filter order compared to FIR filters.</p>
<p>The following example is intended to demonstrate how to design a decimator for specific specifications. It is important to understand the concept behind systems engineering, so that the decimator can be implemented for different parameter values as well. In this case, a decimator is designed for the system in order to reduce the sampling rate of the signal from <strong>220 kHz</strong> to <strong>430 Hz</strong>. The specifications are assumed to be as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Specification</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sampling Rate (<span class="math inline">\(f_s\)</span>)</td>
<td>220 kHz</td>
</tr>
<tr class="even">
<td>Output Sampling Rate (<span class="math inline">\(f_d\)</span>)</td>
<td>430 Hz</td>
</tr>
<tr class="odd">
<td>Passband Edge (<span class="math inline">\(f_p\)</span>)</td>
<td>215 Hz</td>
</tr>
<tr class="even">
<td>Stopband Edge (<span class="math inline">\(f_{sb}\)</span>)</td>
<td>250 Hz</td>
</tr>
<tr class="odd">
<td>Passband Ripple (<span class="math inline">\(\delta_p\)</span>)</td>
<td>0.002</td>
</tr>
<tr class="even">
<td>Stopband Ripple (<span class="math inline">\(\delta_s\)</span>)</td>
<td>0.001</td>
</tr>
<tr class="odd">
<td>OSR</td>
<td>512</td>
</tr>
</tbody>
</table>
<p>The desired decimator with a down-sampling factor <span class="math inline">\(M\)</span> = 512 is shown below.</p>
<div id="fig-desired-decimator" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-desired-decimator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/DesiredDecimator.drawio.svg" class="img-fluid figure-img" style="width:65.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-desired-decimator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.14: Desired Decimator with a down-sampling factor of <span class="math inline">\(M\)</span> = 512
</figcaption>
</figure>
</div>
<p>Since the signal of interest occupies the range <span class="math inline">\([-\pi/\text{OSR}, \pi/\text{OSR}]\)</span>, it can be down-sampled by a factor of OSR without introducing aliasing. This results in a sequence that is sampled at the Nyquist rate <span class="citation" data-cites="pavan2017understanding">(<a href="../elie4/index.html#ref-pavan2017understanding" role="doc-biblioref">Pavan, Schreier, and Temes 2017</a>)</span>, where the output sampling frequency is <span class="math inline">\(f_s = 2 \cdot f_{\text{sig,max}} = 430\,\text{Hz}\)</span>.</p>
<p>The meaningful variables in this overall system are the modulator’s sampling rate <span class="math inline">\(f_s\)</span> and the digital/decimation filter’s output-data rate <span class="math inline">\(f_d\)</span>. The ratio between these two variables is defined as the decimation ratio (DR). In this example, the decimation ratio (DR) is 512, which is the result of dividing the modulator’s sampling rate of 220 kHz by the output data rate of 430 Hz. A high DR reduces quantization noise and results in a higher effective number of bits (ENOB), whereas a low DR leads to increased noise and lower ENOB.</p>
<p>The filter order <span class="math inline">\(N\)</span> (i.e., length <span class="math inline">\(N+1\)</span>) must first be estimated. The required order <span class="math inline">\(N\)</span> can be calculated using the following equation:</p>
<p><span class="math display">\[
N = \frac{-20 \log_{10} \left( \sqrt{\delta_p \delta_s} \right) - 13}{14.6 \Delta f} \tag{16},
\]</span></p>
<p>where <span class="math inline">\(\Delta f = (f_{sb} - f_p) / f_s\)</span> is the normalized transition bandwidth. Alternatively, the filter order of <span class="math inline">\(H(z)\)</span> can also be estimated using the <code>firpmord</code> function. For these specifications, the filter order is <span class="math inline">\(N = 19138\)</span>. Thus, the number of multiplications per second required for the decimation filter is given by:</p>
<p><span class="math display">\[
R_{M,H} = 19138 \cdot 430 = 8{,}229{,}340\ \text{mult/sec.}
\]</span></p>
<p>The obvious problem with this approach is that it is extremely computationally intensive and therefore highly inefficient. It would lead to high power consumption, which is particularly disadvantageous for embedded systems, as well as increased resource usage in general. For this reason, a step-by-step design of a two-stage decimator is considered. First, the decimation filter <span class="math inline">\(H(z)\)</span> is implemented using an IFIR filter. The decimation factor <span class="math inline">\(M\)</span> is factorized as <span class="math inline">\(512 = 256 \cdot 2\)</span>, allowing the interpolation factor <span class="math inline">\(L\)</span> for <span class="math inline">\(F(z^L)\)</span> to be chosen as <span class="math inline">\(L = 256\)</span>. By exploiting the multirate identity, the final two-stage decimator design is derived.</p>
<p>The overall ripple of the filter cascade is given by the sum of the two passband ripples. This can be compensated by designing <span class="math inline">\(G(z)\)</span> and <span class="math inline">\(F(z)\)</span> such that each has an equal passband ripple of <span class="math inline">\(\delta_p = 0.001\)</span> (rather than 0.002). The cascade of <span class="math inline">\(G(z)\)</span> and <span class="math inline">\(F(z)\)</span> achieves a stopband performance at least as good as either <span class="math inline">\(F(z)\)</span> or <span class="math inline">\(G(z)\)</span> individually. Therefore, a stopband ripple of <span class="math inline">\(\delta_s = 0.001\)</span> can be selected for both filters. This corresponds to the specifications of <span class="math inline">\(H(z)\)</span> stretched by a factor of <span class="math inline">\(L = 256\)</span>.</p>
<p>As a result, the filter <span class="math inline">\(F(z)\)</span> has:</p>
<p><span class="math display">\[
f_p = 256 \cdot 215\ \text{Hz} = 55{,}040\ \text{Hz},
\]</span></p>
<p><span class="math display">\[
f_{sb} = 256 \cdot 250\ \text{Hz} = 64{,}000\ \text{Hz}.
\]</span></p>
<p>For the stopband edge of <span class="math inline">\(G(z)\)</span>:</p>
<p><span class="math display">\[
f_s / 256 - f_{sb} = \left({220,000}/{256} - 250\right)\ \text{Hz} = 609\ \text{Hz}.
\]</span></p>
<p>The frequency specifications of <span class="math inline">\(F(z)\)</span> and <span class="math inline">\(G(z)\)</span> are summarized as follows:</p>
<ul>
<li><span class="math inline">\(F(z):\ f_p = 55.04\ \text{kHz},\ f_{sb} = 64\ \text{kHz},\)</span></li>
<li><span class="math inline">\(G(z):\ f_p = 215\ \text{Hz},\ f_{sb} = 609\ \text{Hz}.\)</span></li>
</ul>
<p>The filter orders of <span class="math inline">\(F(z)\)</span> and <span class="math inline">\(G(z)\)</span> estimated using the <code>firpmord</code> function are <span class="math inline">\(N_F = 80\)</span> and <span class="math inline">\(N_G = 1818\)</span>.</p>
<p>The implementation of <span class="math inline">\(F(z)\)</span> followed by a factor-of-2 down-sampler requires:</p>
<p><span class="math display">\[
R_{M,F} = 80 \cdot 430 = 34{,}400\ \text{mult/sec}.
\]</span></p>
<p>The implementation of <span class="math inline">\(G(z)\)</span> followed by a factor-of-256 down-sampler requires:</p>
<p><span class="math display">\[
R_{M,G} = 1818 \cdot 860 = 1{,}563{,}480\ \text{mult/sec}.
\]</span></p>
<p>Therefore, the savings compared to the single-filter design are approximately <strong>81%</strong>.</p>
<p>Below is an illustration summarizing the steps in the two-stage realization of the decimator structure.</p>
<div id="fig-The-steps-in-the-two-stage-realization-of-the-decimator-structure" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-The-steps-in-the-two-stage-realization-of-the-decimator-structure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/MultiStage.drawio.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-The-steps-in-the-two-stage-realization-of-the-decimator-structure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.15: The steps in the two-stage realization of the decimator structure
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="implementation-and-analysis-of-behavior-with-matlab-and-simulink" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Implementation and Analysis of Behavior with MATLAB and Simulink</h1>
<p>To start with the system design and the analyze of the behaviour the following block diagram in <a href="#fig-Block-diagram-of-the-2nd-order-modulator-in-Simulink" class="quarto-xref">Figure&nbsp;<span>7.1</span></a> is shown. The modulator topology is a standard CIFB (cascade of integrators, feedback) structure <span class="citation" data-cites="schreier2005understanding">(<a href="../elie4/index.html#ref-schreier2005understanding" role="doc-biblioref">Schreier, Temes, et al. 2005</a>)</span>.</p>
<div id="fig-Block-diagram-of-the-2nd-order-modulator-in-Simulink" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Block-diagram-of-the-2nd-order-modulator-in-Simulink-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/mod2_matlab.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Block-diagram-of-the-2nd-order-modulator-in-Simulink-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Block diagram of the 2nd-order modulator in Simulink
</figcaption>
</figure>
</div>
<p>In this model, the parameters are defined as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>Specification</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>System Order (L)</td>
<td>2</td>
</tr>
<tr class="even">
<td>Modulator Topology (form)</td>
<td>CIFB</td>
</tr>
<tr class="odd">
<td>Optimization (opt)</td>
<td>0</td>
</tr>
<tr class="even">
<td>Quantizer Levels (nLev)</td>
<td>2 (1‑Bit)</td>
</tr>
<tr class="odd">
<td>Sampling Frequency (<span class="math inline">\(\text{f}_s\)</span>)</td>
<td>220 kHz</td>
</tr>
<tr class="even">
<td>Sampling Time (<span class="math inline">\(\text{T}_s\)</span>)</td>
<td><span class="math inline">\(1 / \text{f}_s\)</span></td>
</tr>
<tr class="odd">
<td>Oversampling Ratio (OSR, M)</td>
<td>512</td>
</tr>
<tr class="even">
<td>Simulation Length (N)</td>
<td><span class="math inline">\(16 \times M = 8192\)</span></td>
</tr>
<tr class="odd">
<td>Bandwidth (<span class="math inline">\(\text{f}_B\)</span>)</td>
<td><span class="math inline">\(\text{f}_s / (2 \times M) \approx 215\)</span> Hz</td>
</tr>
<tr class="even">
<td>Sinus Test Cycles</td>
<td>9</td>
</tr>
<tr class="odd">
<td>Sinus Frequency (<span class="math inline">\(\text{f}_x\)</span>)</td>
<td><span class="math inline">\(cycles \times \text{f}_s / N\)</span></td>
</tr>
<tr class="even">
<td>Test Signal Amplitude (A)</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td>Time Vector (t)</td>
<td><span class="math inline">\(\text{T}_s \times [0:N-1]\)</span></td>
</tr>
<tr class="even">
<td>Input Signal (u)</td>
<td><span class="math inline">\(A \cdot \sin(2\pi \cdot \text{f}_x / \text{f}_s \cdot [0:N-1])\)</span></td>
</tr>
</tbody>
</table>
<p>In this model, the parameter L is set to 2, indicating that the DSM is of second order. The topology is defined by form = ‘CIFB’, which specifies the Cascade of Integrator Feedback configuration — a standard structure for delta-sigma designs. The parameters <span class="math inline">\(f_s\)</span> and <span class="math inline">\(T_s\)</span> denote the sampling frequency and sampling period, respectively. The oversampling ratio is determined by <span class="math inline">\(M\)</span> = 512, while the simulation length — and consequently the number of FFT points — is set by <span class="math inline">\(N = 16 \cdot M\)</span>. Finally, <span class="math inline">\(u\)</span> represents the sinusoidal input signal for the modulator.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Design NTF</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">H</span> <span class="op">=</span> <span class="va">synthesizeNTF</span>(<span class="va">L</span><span class="op">,</span> <span class="va">M</span><span class="op">,</span> <span class="va">opt</span><span class="op">,</span> <span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">a</span><span class="op">,</span> <span class="va">g</span><span class="op">,</span> <span class="va">b</span><span class="op">,</span> <span class="va">c</span>] <span class="op">=</span> <span class="va">realizeNTF</span>(<span class="va">H</span><span class="op">,</span> <span class="va">form</span>)<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">b</span>(<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>) <span class="op">=</span> <span class="fl">0</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="va">ABCD</span> <span class="op">=</span> <span class="va">stuffABCD</span>(<span class="va">a</span><span class="op">,</span> <span class="va">g</span><span class="op">,</span> <span class="va">b</span><span class="op">,</span> <span class="va">c</span><span class="op">,</span> <span class="va">form</span>)<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>[<span class="va">ABCDs</span><span class="op">,</span> <span class="va">umax</span>] <span class="op">=</span> <span class="va">scaleABCD</span>(<span class="va">ABCD</span>)<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>[<span class="va">a</span><span class="op">,</span> <span class="va">g</span><span class="op">,</span> <span class="va">b</span><span class="op">,</span> <span class="va">c</span>] <span class="op">=</span> <span class="va">mapABCD</span>(<span class="va">ABCDs</span><span class="op">,</span> <span class="va">form</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>One of the most important sections of code is shown above. SynthesizeNTF(L, M, opt, 2) designs the noise-transfer function polynomial based on the modulator order <strong>L</strong>, the oversampling ratio <strong>M</strong>, and additional parameters. The function realizeNTF(H, form) generates specific coefficients (<strong>a</strong>, <strong>g</strong>, <strong>b</strong>, <strong>c</strong>) for the chosen topology (CIFB). The operation <code>b(2:end) = 0</code> sets certain feedback paths to zero, often for simplification or demonstration purposes. Subsequently, the functions stuffABCD(…), scaleABCD(…), and mapABCD(…) transform and scale the state-space representation of the modulator (the ABCD matrix) to achieve a more favorable implementation, such as reducing the signal levels in the integrators. In this case, the Noise Transfer Function is given by:</p>
<p><span class="math display">\[
H(z) = \frac{(z - 1)^2}{z^2 - 0.7639z + 0.2361} \tag{17}
\]</span></p>
<div id="fig-PWM" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-PWM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/PWM.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-PWM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: 2nd Order Sigma-Delta Modulator Output
</figcaption>
</figure>
</div>
<p>The result of the modulator can be seen in <a href="#fig-PWM" class="quarto-xref">Figure&nbsp;<span>7.2</span></a>. The simulation result is as expected. The modulator converts the analog input signal into a high-speed, single-bit, pulse-width modulated waveform. However, the modulator output has certain drawbacks, including high-frequency noise and a fast 1-bit output rate. Once the signal is in the digital domain, a low-pass digital filter can be applied to reduce high-frequency noise, while a decimation filter can be used to decrease the output data rate. When the input signal reaches its peak amplitude, the PWM output consists of densely packed high pulses, corresponding to a high duty cycle. Conversely, when the input signal has a lower amplitude, the density of high pulses decreases, resulting in a lower duty cycle. This time-domain pulse-density modulation effectively represents the amplitude of the analog signal and enables accurate reconstruction after digital filtering and decimation.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Applications of PWM Signals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Applications of PWM Signals
</div>
</div>
<div class="callout-body-container callout-body">
<p>In delta-sigma ADCs, the PWM output is filtered and decimated; however, it is important to mention that PWM is also widely used in various applications due to its efficiency in controlling power and transmitting signals. In audio applications, PWM is employed in Class-D amplifiers, where the modulated signal directly drives the speaker. It is also utilized in digital-to-analog conversion, particularly in pulse-density modulation (PDM)-based systems like DSD (Direct Stream Digital) audio. Furthermore, PWM plays a crucial role in motor control and power regulation, enabling precise adjustments in speed and energy efficiency.</p>
</div>
</div>
<div id="fig-Comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Comparison_first_second_third.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: Comparison: 1st vs.&nbsp;2nd vs.&nbsp;3rd Order Delta-Sigma
</figcaption>
</figure>
</div>
<p><a href="#fig-Comparison" class="quarto-xref">Figure&nbsp;<span>7.3</span></a> shows a comparison between 1st, 2nd, and 3rd order delta-sigma modulators in the frequency domain. It is clearly visible that higher-order modulators provide stronger attenuation of quantization noise in the low-frequency (baseband) region. The 3rd order modulator is the most effective in suppressing noise within the signal band. However, the noise level increases at higher frequencies as the modulator order increases.</p>
</section>
<section id="switched-capacitor" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Switched Capacitor</h1>
<p>Switched capacitor (SC) circuits play a fundamental role in modern mixed-signal systems, particularly in the implementation of high-performance ADCs. By replacing traditional resistors with switches and capacitors, SC circuits offer precise and controllable analog signal processing using standard CMOS technology. This makes them highly suitable for integration in low-power, high-accuracy applications.</p>
<p>The core principle of a switched capacitor circuit is based on the controlled transfer of charge between capacitors through electronic switches. These switches are typically driven by non-overlapping clock phases that define the sampling (track) and holding intervals. During the track phase, the switch closes, allowing the capacitor to sample and store the input voltage. Once the switch opens (hold phase), the stored charge represents the sampled value, which can then be processed or transferred further along the signal chain. This sample-and-hold functionality is a critical building block for discrete-time signal processing.</p>
<p>In essence, switched capacitor circuits emulate the behavior of resistors by controlling the rate at which charge is moved between nodes. The equivalent resistance is determined by the capacitance value and the switching frequency. As a result, SC circuits provide highly accurate and stable performance that is less sensitive to process variations, temperature, and voltage changes compared to traditional resistor-based circuits.</p>
<p>Switched capacitor techniques are widely employed in integrators, filters, and analog-to-digital conversion stages, such as the integrator loops of Sigma-Delta ADCs. These circuits benefit from their compatibility with digital control logic, making them an essential component in modern integrated circuit design.</p>
<hr>
<section id="clock-phases-in-switched-capacitor-circuits" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="clock-phases-in-switched-capacitor-circuits"><span class="header-section-number">8.1</span> Clock Phases in Switched Capacitor Circuits</h2>
<p>Switched capacitor circuits rely heavily on precise timing signals to control the switching events. Typically, two non-overlapping clock signals, denoted as Φ₁ and Φ₂, are used to drive the switches. These two clock phases ensure that switches are never simultaneously closed, which would otherwise create short circuits and result in charge sharing errors.</p>
<section id="non-overlapping-clock-phases" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="non-overlapping-clock-phases"><span class="header-section-number">8.1.1</span> Non-overlapping Clock Phases</h3>
<p>In <a href="#fig-clock" class="quarto-xref">Figure&nbsp;<span>8.1</span></a>, the basic waveforms of Φ₁ and Φ₂ are shown. Φ₁ is high during one period while Φ₂ remains low. After Φ₁ transitions to low, Φ₂ becomes high. This non-overlapping behavior is essential for reliable charge transfer in switched capacitor circuits.</p>
<div id="fig-clock" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clock-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/clock.drawio.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clock-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Non-Overlapping Clock Phases
</figcaption>
</figure>
</div>
<p>These clock phases alternate, controlling the sampling and transfer of charge between nodes. The duration of the clock period and its frequency directly affect the equivalent resistance of the switched capacitor circuit. Specifically, the equivalent resistance R_eq can be described as:</p>
<p><span class="math display">\[
R_{eq} = \frac{1}{f \cdot C} \tag{18}
\]</span></p>
<p>Where f is the clock frequency, and C is the value of the switched capacitor.</p>
<hr>
</section>
</section>
<section id="timing-diagrams-for-switched-capacitor-operation" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="timing-diagrams-for-switched-capacitor-operation"><span class="header-section-number">8.2</span> Timing Diagrams for Switched Capacitor Operation</h2>
<p>Understanding the timing behavior of Φ₁ and Φ₂ in different clocking schemes is essential for accurate circuit operation. In <a href="#fig-clock2" class="quarto-xref">Figure&nbsp;<span>8.2</span></a>, we see an extended timing diagram of Φ₁ and Φ₂ that emphasizes their non-overlapping nature over multiple cycles.</p>
<p>This timing control prevents both switches from conducting at the same time, thereby avoiding charge injection errors and signal corruption. Such precision in clock phase control is a defining feature of CMOS-based SC implementations.</p>
<div id="fig-clock2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clock2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/clock2.drawio.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clock2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: Timing Diagram of Clock Phases
</figcaption>
</figure>
</div>
<p>The rise and fall times, as well as the phase separation, are carefully designed in modern integrated circuits to minimize clock feedthrough and other non-ideal effects.</p>
<hr>
</section>
<section id="basic-switched-capacitor-circuit-operation" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="basic-switched-capacitor-circuit-operation"><span class="header-section-number">8.3</span> Basic Switched Capacitor Circuit Operation</h2>
<p>The simplest switched capacitor circuit, as shown in Figure 3, consists of two switches and one capacitor. This configuration serves as a charge pump, moving charge from an input node to an output node in discrete time intervals controlled by the clock phases Φ₁ and Φ₂.</p>
<section id="operating-principle" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="operating-principle"><span class="header-section-number">8.3.1</span> Operating Principle</h3>
<ol type="1">
<li>During Φ₁, switch S₁ is closed, allowing the capacitor C₁ to charge up to the input voltage V₁.</li>
<li>During Φ₂, switch S₁ opens and switch S₂ closes, transferring the stored charge from the capacitor to the output node V₂.</li>
</ol>
<p>This charge transfer process effectively samples the input signal and transfers its equivalent charge to the next stage. The circuit emulates the behavior of a resistor by relating the transferred charge to the voltage difference and the switching frequency.</p>
<p>The operation of this circuit can be explained using charge conservation:</p>
<p><span class="math display">\[
Q = C \cdot V \tag{19}
\]</span></p>
<p>The charge transferred per cycle depends on the input voltage and the capacitance, while the average current is given by:</p>
<p><span class="math display">\[
I_{avg} = \frac{Q}{T} = C \cdot V \cdot f \tag{20}
\]</span></p>
<p>This explains how the circuit behaves like a resistor with resistance 1 / (C · f).</p>
<div id="fig-SC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/SC.drawio.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.3: Basic Switched Capacitor Circuit
</figcaption>
</figure>
</div>
<p>By employing non-overlapping clock signals and discrete charge sampling, SC circuits successfully replicate the behavior of passive resistor networks in integrated circuits.</p>
<p>Such designs form the foundation of analog filters, integrators, and ADC building blocks, especially in Sigma-Delta modulation schemes. Understanding these fundamentals allows for the design and implementation of low-power, high-precision, and scalable analog signal processing systems.</p>
</section>
</section>
<section id="area-efficiency-and-frequency-control-in-switched-capacitor-circuits" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="area-efficiency-and-frequency-control-in-switched-capacitor-circuits"><span class="header-section-number">8.4</span> Area Efficiency and Frequency Control in Switched Capacitor Circuits</h2>
<p>One of the main challenges is implementing large and accurate resistances without consuming excessive silicon area. Unlike continuous-time RC filters, which require physically large resistors to achieve low-frequency operation, switched capacitor circuits can emulate resistances through controlled charge transfer, depending only on the clock frequency and the capacitor value. This technique allows designers to achieve high accuracy and area efficiency.</p>
<p>The schematic shown in <a href="#fig-sc_switches" class="quarto-xref">Figure&nbsp;<span>8.4</span></a> illustrates a basic switched capacitor structure controlled by non-overlapping clock phases Φ₁ and Φ₂. During Φ₁, the capacitor is connected to the input, allowing it to charge. During Φ₂, the charge is transferred to the output. This operation is equivalent to moving discrete packets of charge, simulating the current that would flow through a resistor.</p>
<div id="fig-sc_switches" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sc_switches-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/sc_switches.drawio.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sc_switches-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.4: Switched Capacitor
</figcaption>
</figure>
</div>
<p>One of the most valuable properties of switched capacitor circuits is that their equivalent resistance is defined by:</p>
<p><span class="math display">\[
R_{eq} = \frac{1}{C \cdot f} \tag{21}
\]</span></p>
<p>Where C is the capacitance and f is the switching frequency. This makes the resistance predictable and easily tunable by simply adjusting the clock frequency, without relying on process-sensitive resistor fabrication.</p>
<p>The area savings come from the fact that capacitors generally occupy less silicon area than high-value resistors. Additionally, the matching between capacitors is typically better than the matching between resistors, resulting in more stable and accurate circuit behavior. These advantages make switched capacitor circuits ideal for applications such as integrators in Sigma-Delta ADCs, switched capacitor filters, and precision analog signal processing.</p>
<p>Finally, because the resistance value depends entirely on the switching frequency and capacitance, designers can dynamically modify a filter’s frequency response by changing the clock rate, providing additional flexibility in system design.</p>
</section>
</section>
<section id="ltspice-simulation-of-an-idealized-second-order-sigma-delta-modulator" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> LTSpice Simulation of an Idealized Second-Order Sigma-Delta Modulator</h1>
<p>In this section, the behavior of an idealized second-order Sigma-Delta (ΔΣ) modulator is demonstrated using an LTSpice simulation. The purpose of this simulation is to validate the fundamental operation of the switched capacitor stages and integrator loops prior to implementing a more realistic circuit.</p>
<p>The model consists of two cascaded switched capacitor integrator stages, followed by a comparator and a digital feedback path. The switched capacitor stages are configured to emulate integrators, where the charge transfer mechanism accurately models the behavior of continuous-time integrators in a discrete-time domain.</p>
<p>The schematic shown in <a href="#fig-dsm_l2" class="quarto-xref">Figure&nbsp;<span>9.1</span></a> represents the complete simulation setup implemented in LTSpice. The primary blocks in this design are: - <strong>Switched Capacitor Integrators</strong>: Each integrator is implemented using an ideal operational amplifier model and switched capacitors that mimic charge transfer. The capacitors Cs1/Ci1 and Cs2/Ci2 define the integrator characteristics and influence the loop filter coefficients. - <strong>Clock Phases (Φ₁ and Φ₂)</strong>: Two non-overlapping clock signals control the timing of the switches. These clock signals are generated by voltage sources modeled as pulse generators in LTSpice, ensuring the correct timing and preventing overlap, which is critical to avoid signal corruption. - <strong>Comparator</strong>: An ideal comparator converts the analog output of the second integrator stage into a digital logic level. - <strong>Feedback Path</strong>: The output of the comparator is fed back into the modulator, closing the loop. The feedback ensures stability and noise shaping, both characteristic behaviors of ΣΔ modulators. - <strong>D Flip-Flop</strong>: The comparator output passes through a D Flip-Flop to synchronize the output with the system clock, ensuring stable digital outputs.</p>
<div id="fig-dsm_l2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dsm_l2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/dsm_l2.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dsm_l2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: LTSpice Simulation of Second-Order Sigma-Delta Modulator
</figcaption>
</figure>
</div>
<hr>
<section id="key-components-and-operation" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="key-components-and-operation"><span class="header-section-number">9.1</span> Key Components and Operation</h2>
<p><strong>Clock Phase Control:</strong> The simulation uses ideal switches controlled by two non-overlapping clock phases Φ₁ and Φ₂ at a frequency of 220 kHz. These clocks are modeled with pulse generators and are configured to ensure there is no overlap. This guarantees that charge transfer occurs without any unintended charge sharing or signal corruption.</p>
<p><strong>Switched Capacitor Stages:</strong> Each switched capacitor stage consists of: - Sampling capacitors Cs1 and Cs2. - Integration capacitors Ci1 and Ci2. - A set of four switches per stage that perform the sampling and integration steps.</p>
<p>The switched capacitor integrators convert the input voltage signal into a charge packet transferred at each clock cycle. This process allows the integrator stages to perform accurate discrete-time integration, critical for the loop filter performance in a ΣΔ modulator.</p>
<p><strong>Operational Amplifiers:</strong> The integrators are idealized as operational transconductance amplifiers (OTAs), realized in LTSpice as voltage-controlled current sources. In the ideal model, the OTA provides a linear response across the full input range. In practical designs, care must be taken to ensure that the OTA does not enter saturation, which would otherwise violate the assumptions made in this idealized simulation.</p>
<p><strong>Comparator and Feedback:</strong> The second integrator’s output is connected to an ideal comparator. Its digital output is fed back through the feedback path to both integrator stages. This feedback enforces the quantization noise shaping inherent to ΣΔ modulators.</p>
<p><strong>Simulation Setup:</strong> The simulation parameters include: - Power supply voltage VDD = 1.5 V - Common-mode voltage VCM = 0.75 V - Input signal: A sine wave with an amplitude of 0.5 V centered at VCM - Capacitor values: - <strong>Cs1 = 1 pF</strong>, <strong>Ci1 = 6 pF</strong> - <strong>Cs2 = 1 pF</strong>, <strong>Ci2 = 3 pF</strong></p>
<p>The transient simulation runs for 30 ms, capturing all relevant node voltages such as vx1, vx2, vq, and vd.</p>
<hr>
<p>This LTSpice simulation demonstrates the core functionality of an idealized second-order Sigma-Delta modulator, including: - Precise clock phase control to prevent signal corruption. - Switched capacitor integrator stages emulating discrete-time integration. - Quantization feedback ensuring noise shaping and high-resolution analog-to-digital conversion.</p>
<p>This model serves as a foundation for developing more realistic circuits, where non-idealities such as switch resistance, parasitic capacitance, and finite OTA gain are considered.</p>
</section>
<section id="output-signals-of-the-first-and-second-integrator-stages" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="output-signals-of-the-first-and-second-integrator-stages"><span class="header-section-number">9.2</span> Output Signals of the First and Second Integrator Stages</h2>
<p>Following the LTSpice simulation of the idealized second-order Sigma-Delta modulator, the voltage outputs of the first and second integrator stages were analyzed. These signals provide crucial insight into the operation and dynamic behavior of the modulator’s loop filter.</p>
<p>The voltage waveform V(vx1) represents the output of the first integrator, while V(vx2) corresponds to the output of the second integrator. Both signals are critical in understanding the internal signal processing and how the modulator shapes the quantization noise.</p>
<section id="integrator-1-output---vvx1" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="integrator-1-output---vvx1"><span class="header-section-number">9.2.1</span> Integrator 1 Output - V(vx1)</h3>
<p>The output of the first integrator, V(vx1), shows the integration of the input signal combined with the feedback from the quantizer. The integrator accumulates charge, resulting in a signal that closely follows the low-frequency components of the input while reacting to the feedback signal to suppress quantization noise within the signal band.</p>
<p>The waveform of V(vx1) demonstrates: - A smoother signal profile compared to the input, due to its integration function. - Oscillations introduced by the feedback loop as the system attempts to keep the quantization error shaped and controlled.</p>
</section>
<section id="integrator-2-output---vvx2" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="integrator-2-output---vvx2"><span class="header-section-number">9.2.2</span> Integrator 2 Output - V(vx2)</h3>
<p>The output of the second integrator, V(vx2), exhibits an even higher degree of integration. It represents the second accumulation in the cascade, further enhancing the low-pass filtering effect of the loop filter. This output typically shows: - A stronger suppression of high-frequency components. - More pronounced signal swings, as the second integrator amplifies the difference between the first integrator’s output and the feedback signal from the comparator.</p>
<p>The dynamic range of V(vx2) is larger than that of V(vx1), illustrating the additional integration stage’s impact. The output of the second integrator directly feeds into the quantizer (comparator), making its behavior essential to achieving the desired noise shaping properties.</p>
</section>
<section id="output-waveforms-visualization" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="output-waveforms-visualization"><span class="header-section-number">9.2.3</span> Output Waveforms Visualization</h3>
<p>The time-domain waveforms for both integrator outputs are shown in <a href="#fig-Output1_2" class="quarto-xref">Figure&nbsp;<span>9.2</span></a> below. The x-axis represents the simulation time (0 ms to 30 ms), while the y-axis represents the output voltages of the two integrators. The distinct differences in the signal shapes illustrate the successive integration performed by each stage.</p>
<div id="fig-Output1_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Output1_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/Output1_2.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Output1_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Integrator Outputs of the Sigma-Delta Modulator
</figcaption>
</figure>
</div>
<p>The key observations from these output signals are: - The first integrator output V(vx1) follows the integrated input and feedback signals, acting as the first stage of the loop filter.</p>
<ul>
<li><p>The second integrator output V(vx2) provides a deeper integration, smoothing out the signal further and preparing it for quantization.</p></li>
<li><p>Both outputs confirm the correct operation of the switched capacitor integrator stages and validate the simulation model.</p></li>
</ul>
<p>The correct functioning of these integrators is fundamental to ensuring the modulator shapes quantization noise effectively. In a practical implementation, the design of these integrators would have to consider non-idealities such as finite OTA gain, thermal noise, and parasitic capacitances. However, for this idealized simulation, the results closely match the expected theoretical behavior.</p>
</section>
</section>
<section id="ltspice-ota-representation" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="ltspice-ota-representation"><span class="header-section-number">9.3</span> LTspice OTA representation</h2>
<p>In modern analog and mixed-signal circuit design, the OTA plays a critical role, particularly in switched-capacitor integrators and analog filters. Unlike traditional opamps, which act as voltage-controlled voltage sources, OTAs behave as voltage-controlled current sources. The key advantage of an OTA lies in its ability to directly control the output current by varying the input differential voltage, making it well-suited for fully integrated implementations.</p>
<p>An OTA can be modeled in several ways depending on the design stage. Below, we present both a simplified behavioral model used for system-level simulations in LTSpice, and a transistor-level implementation suitable for IC design.</p>
<section id="behavioral-model-of-the-ota-in-ltspice" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="behavioral-model-of-the-ota-in-ltspice"><span class="header-section-number">9.3.1</span> Behavioral Model of the OTA in LTSpice</h3>
<p>For early-stage system verification and discrete-time simulations, a simplified behavioral representation of the OTA can be implemented in LTSpice. This model typically consists of a Voltage-Controlled Current Source (VCCS) combined with an output resistor. The VCCS outputs a current proportional to the difference between the two input voltages (\(V_{in+} - V_{in-}\)), while the resistor converts the current into an output voltage.</p>
<p>In this model, the OTA is assumed to operate in its linear region, ensuring that the output current is linearly dependent on the input differential voltage. This linear model is valid as long as the input signal remains within the OTA’s linear input range. If the OTA is driven into saturation, this behavioral model no longer accurately describes its performance.</p>
<div id="fig-ideal_ota" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ideal_ota-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ideal_ota.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ideal_ota-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: LTSpice OTA Behavioral Model
</figcaption>
</figure>
</div>
<p>In the example shown above: - <code>Gm</code> represents the transconductance element of the OTA.<br>
- <code>RL</code> is the load resistor converting current to voltage.<br>
- The <code>Vin+</code> and <code>Vin-</code> nodes are the positive and negative differential inputs, respectively.</p>
<p>The transconductance factor (<code>gm</code>) determines the gain of the OTA. In the simulation, <code>G</code> has a gain of 1000, providing an output current of<br>
<span class="math display">\[
I_{out} = G \cdot (V_{in+} - V_{in-}) \tag{22}
\]</span></p>
<p>The resistor <code>RL</code> converts this current into a voltage drop at the <code>Out</code> terminal.</p>
</section>
<section id="transistor-level-of-the-ota" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="transistor-level-of-the-ota"><span class="header-section-number">9.3.2</span> Transistor-Level of the OTA</h3>
<p>For transistor-level design and IC layout, a more accurate model of the OTA is implemented using MOSFETs. The differential pair forms the input stage, converting the input differential voltage into a differential current. Current mirrors and load transistors process this current, providing the desired output characteristics.</p>
<p>The following schematic shows a fully differential OTA structure commonly used in analog integrated circuits:</p>
<div id="fig-Transistor-Level-OTA-Schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Transistor-Level-OTA-Schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ota.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Transistor-Level-OTA-Schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: Transistor-Level OTA Schematic
</figcaption>
</figure>
</div>
<p>In this circuit: - The differential pair (<code>Vin+</code> and <code>Vin-</code>) provides the input transconductance function.<br>
- The current mirrors at the top and bottom bias and mirror the current for differential operation.<br>
- The differential outputs <code>Vout</code> and <code>Vinn</code> allow for fully differential signal processing, improving noise immunity and power supply rejection.</p>
<p>The input differential pair operates in the saturation region, where the drain current<br>
<span class="math display">\[
I_D = \frac{1}{2} \mu C_{ox} \frac{W}{L} (V_{GS} - V_{TH})^2 \tag{23}
\]</span><br>
is controlled by the gate-source voltage difference. The output current is mirrored and converted into a differential voltage across the load devices.</p>
</section>
<section id="comparison-between-the-models" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="comparison-between-the-models"><span class="header-section-number">9.3.3</span> Comparison Between the Models</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 40%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Aspect</strong></th>
<th><strong>LTSpice Behavioral Model</strong></th>
<th><strong>Transistor-Level Implementation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Complexity</strong></td>
<td>Simple and fast for simulation</td>
<td>Accurate but complex and slower simulation</td>
</tr>
<tr class="even">
<td><strong>Use Case</strong></td>
<td>Circuit-level simulations, functional testing</td>
<td>Device-level design, IC schematic, performance validation</td>
</tr>
<tr class="odd">
<td><strong>Nonlinear Effects</strong></td>
<td>Ignored (ideal behavior)</td>
<td>Fully considered (real-world performance)</td>
</tr>
<tr class="even">
<td><strong>Saturation / Nonlinearity</strong></td>
<td>Not modeled</td>
<td>Modeled according to device physics</td>
</tr>
</tbody>
</table>
<p>By combining both models in the design flow, system functionality can be verified early with the LTSpice behavioral model, while detailed electrical characteristics are analyzed with the transistor-level implementation. The following sections will represent th IC-schematic with xschem.</p>
</section>
</section>
</section>
<section id="basic-ota-sizing-strategy" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Basic OTA Sizing Strategy</h1>
<p>Device sizing is a fundamental step in analog circuit design. Specifically, for Operational Transconductance Amplifiers (OTAs), proper sizing ensures the desired trade-off between gain, bandwidth, power consumption, and linearity. A structured approach to sizing guarantees that the transistors operate in their optimal region—typically strong inversion and saturation for analog applications.</p>
<p>This section presents a basic OTA sizing methodology based on the work of Prepl, whose notebook is publicly available at <a href="https://github.com/iic-jku/analog-circuit-design/blob/main/sizing/sizing_basic_ota.ipynb">GitHub: analog-circuit-design</a>.</p>
<p>The notebook demonstrates a Python-based framework for calculating initial transistor dimensions in a basic OTA. Below is an explanation of the key steps, equations, and important code snippets from the sizing method, along with visual aids to clarify the process.</p>
<p>The sizing workflow follows these general steps:</p>
<ol type="1">
<li>Define technology and process parameters.</li>
<li>Specify bias currents and overdrive voltages.</li>
<li>Calculate width-to-length ratios (W/L) for each transistor.</li>
<li>Determine transconductance, output resistance, and gain.</li>
<li>Evaluate key performance metrics like slew rate and gain-bandwidth product.</li>
</ol>
<p>At the beginning of the notebook, fundamental technology parameters are defined, including supply voltages, threshold voltages, mobility, and channel-length modulation factors for NMOS and PMOS transistors.</p>
<div id="1f52d150" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Technology and model parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>VDD <span class="op">=</span> <span class="fl">1.8</span>     <span class="co"># Supply voltage [V]</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>VTHN <span class="op">=</span> <span class="fl">0.4</span>    <span class="co"># NMOS threshold voltage [V]</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>VTHP <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span>   <span class="co"># PMOS threshold voltage [V]</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mu_n_Cox <span class="op">=</span> <span class="fl">200e-6</span>  <span class="co"># NMOS process transconductance parameter [A/V^2]</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>mu_p_Cox <span class="op">=</span> <span class="fl">100e-6</span>  <span class="co"># PMOS process transconductance parameter [A/V^2]</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>lambda_n <span class="op">=</span> <span class="fl">0.1</span>     <span class="co"># Channel length modulation NMOS [1/V]</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>lambda_p <span class="op">=</span> <span class="fl">0.1</span>     <span class="co"># Channel length modulation PMOS [1/V]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These parameters are critical for calculating transistor drain current in saturation:</p>
<p><span class="math display">\[
I_D = \frac{1}{2} \mu C_{ox} \frac{W}{L} (V_{GS} - V_{TH})^2 \tag{24}
\]</span></p>
<p>The differential pair (M1 and M2) defines the input transconductance of the OTA. Sizing begins by selecting bias current and overdrive voltage (V<span class="math inline">\(_{OV}\)</span>):</p>
<div id="80ae101c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bias current for each NMOS transistor</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ID1 <span class="op">=</span> <span class="fl">100e-6</span>   <span class="co"># [A]</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overdrive voltage for M1 and M2</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>VOV1 <span class="op">=</span> <span class="fl">0.2</span>     <span class="co"># [V]</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate W/L ratio for M1 and M2</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>WL1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> ID1 <span class="op">/</span> (mu_n_Cox <span class="op">*</span> VOV1<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"W/L for M1 and M2: </span><span class="sc">{</span>WL1<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>W/L for M1 and M2: 25.00</code></pre>
</div>
</div>
<p>In this example: - Bias current (ID1) is 100 µA per transistor. - Overdrive voltage (VOV1) is 0.2 V. - Calculated W/L ensures M1 and M2 operate in saturation with desired transconductance.</p>
<p>The tail current source (M5) provides total bias current to the differential pair:</p>
<div id="a652421f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tail current source sizing (M5)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ID5 <span class="op">=</span> <span class="fl">200e-6</span>   <span class="co"># Total bias current [A]</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>VOV5 <span class="op">=</span> <span class="fl">0.2</span>     <span class="co"># Overdrive voltage [V]</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>WL5 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> ID5 <span class="op">/</span> (mu_n_Cox <span class="op">*</span> VOV5<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"W/L for M5: </span><span class="sc">{</span>WL5<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>W/L for M5: 50.00</code></pre>
</div>
</div>
<p>M5 carries the combined current of M1 and M2, typically twice ID1.</p>
<p>PMOS current mirrors (M3 and M4) act as active loads for the differential pair, impacting gain and output resistance:</p>
<div id="cc5fdeb9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load transistors sizing (M3 and M4)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ID3 <span class="op">=</span> <span class="fl">100e-6</span>   <span class="co"># [A]</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>VOV3 <span class="op">=</span> <span class="fl">0.2</span>     <span class="co"># [V]</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>WL3 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> ID3 <span class="op">/</span> (mu_p_Cox <span class="op">*</span> VOV3<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"W/L for M3 and M4: </span><span class="sc">{</span>WL3<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>W/L for M3 and M4: 50.00</code></pre>
</div>
</div>
<p>Lowering overdrive voltage (V<span class="math inline">\(_{OV3}\)</span>) increases output resistance, improving OTA voltage gain.</p>
<p>Once W/L ratios are calculated, device transconductance (g<span class="math inline">\(_m\)</span>) and output resistance (r<span class="math inline">\(_o\)</span>) are derived:</p>
<div id="84768c06" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gm1 <span class="op">=</span> mu_n_Cox <span class="op">*</span> WL1 <span class="op">*</span> VOV1 <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ro1 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (lambda_n <span class="op">*</span> ID1)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ro3 <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (lambda_p <span class="op">*</span> ID3)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"gm1: </span><span class="sc">{</span>gm1<span class="sc">:.2e}</span><span class="ss"> S"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ro1: </span><span class="sc">{</span>ro1<span class="sc">:.2e}</span><span class="ss"> Ω"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ro3: </span><span class="sc">{</span>ro3<span class="sc">:.2e}</span><span class="ss"> Ω"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gm1: 5.00e-04 S
ro1: 1.00e+05 Ω
ro3: 1.00e+05 Ω</code></pre>
</div>
</div>
<p>The OTA’s DC gain is:</p>
<p><span class="math display">\[
A_v = g_{m1} \cdot (r_{o1} \parallel r_{o3}) \tag{25}
\]</span></p>
<p>In Python:</p>
<div id="9af92468" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Av <span class="op">=</span> gm1 <span class="op">*</span> (ro1 <span class="op">*</span> ro3) <span class="op">/</span> (ro1 <span class="op">+</span> ro3)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Voltage gain A_v: </span><span class="sc">{</span>Av<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Voltage gain A_v: 25.00</code></pre>
</div>
</div>
<p><strong>Evaluating Performance Metrics - Slew Rate and GBW:</strong></p>
<p>Slew rate and gain-bandwidth product (GBW) predict OTA dynamic performance:</p>
<div id="0447d1b6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>CL <span class="op">=</span> <span class="fl">1e-12</span>   <span class="co"># Load capacitance [F]</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Slew rate calculation</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>SR <span class="op">=</span> ID5 <span class="op">/</span> CL</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Slew Rate: </span><span class="sc">{</span>SR<span class="sc">:.2e}</span><span class="ss"> V/s"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gain Bandwidth Product (GBW)</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>GBW <span class="op">=</span> gm1 <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> CL)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Gain Bandwidth Product: </span><span class="sc">{</span>GBW<span class="sc">:.2e}</span><span class="ss"> Hz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Slew Rate: 2.00e+08 V/s
Gain Bandwidth Product: 7.96e+07 Hz</code></pre>
</div>
</div>
<ul>
<li><strong>Slew Rate (SR)</strong>: OTA’s ability to respond to large signals.</li>
<li><strong>Gain Bandwidth Product (GBW)</strong>: Small-signal frequency response.</li>
</ul>
<p>The presented methodology offers a systematic, reproducible approach to OTA design. Starting with hand calculations and validating through simulation helps designers optimize OTA performance while balancing speed, power, and gain. This lays groundwork for addressing noise, mismatch, and layout parasitics. Further information is publicly available at <a href="https://github.com/iic-jku/analog-circuit-design/blob/main/sizing/sizing_basic_ota.ipynb">GitHub: analog-circuit-design</a>.</p>
</section>
<section id="incremental-delta-sigma-modulators" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Incremental Delta Sigma Modulators</h1>
<p>As mentioned above Delta-Sigma Modulators play a huge role in electronics. In the following chapters we will take a look at our design steps, understand the fundamental building blocks of our Modulator and discuss the working principles.</p>
<p>While in continues time delta-sigma ADCs the analog input voltage is converted to a digital bitsteam continuesly, in incremental dsm’s this happens in small “blocks”. After each block the internal circuitry is resettet by a pulse and the conversion happens again. <span class="citation" data-cites="incrementaldsm">(<a href="../elie4/index.html#ref-incrementaldsm" role="doc-biblioref">Markus, Silva, and Temes 2004</a>)</span> In our circuits we will see the timing requirements of the two clock phases and the timing of the reset pulse which is applied to different stages like the integrating capacitor.</p>
<section id="iic-tools-and-ihp-sg13g2-pdk" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="iic-tools-and-ihp-sg13g2-pdk"><span class="header-section-number">11.1</span> IIC-Tools and IHP-SG13G2 PDK</h2>
<p>The IIC-OSIC-Tools Repo is a collection of different tools used for open source IC design, simulation and layout. This repository is forked from the origial Repo written by efabless. It contains xschem, klayout, the open pdk’s and ngspice which is used to simulate the drawn circuits in xschem <span class="citation" data-cites="IIC_OSIC_TOOLS">(<a href="../elie4/index.html#ref-IIC_OSIC_TOOLS" role="doc-biblioref">H. Pretl 2025</a>)</span>.</p>
<p>The open source SG13G2 PDK from the Leibniz Institute for High Performance Electronics contains different building blocks like pmos and nmos field effect transistors as well as polysiicon resistors and MIM capacitors. The smallest structures that can be made are 130 nm small. This feature size is utilized in FETs and is the lower limit. In electronics design and engineering in general we have to be careful with designing circuits and systems at their limits. This feature size is called the lower limit for a reason and should only be utilized if necessary. <span class="citation" data-cites="IHP_SG13G2">(<a href="../elie4/index.html#ref-IHP_SG13G2" role="doc-biblioref">IHP 2025</a>)</span></p>
</section>
</section>
<section id="ingegrated-circuit-design" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Ingegrated Circuit Design</h1>
<section id="operational-amplifier" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="operational-amplifier"><span class="header-section-number">12.1</span> Operational Amplifier</h2>
<p>One of the most important components in analog electronics is the operational amplifier. The OpAmp can be used to amplifiy or attenuate signals, to decouple signals (unity-gain amplifier) in order not to load a signal sources, to build filters (biquad filters) and other signal processing circuits and to build circuits like integrators, comparators and summing amplifiers.</p>
<p>Operational Amplifiers basically amplify the voltage difference between their input terminals, the inverting and non-inverting input. This amplified differential voltage can then be further processed by the following circuitry. By applying some of the output signal back to the input more complex behaviour and also mathematical operations can be performed. By for example adding a feedback capacitor from the output to the inverting input togehter with a resistor at the inverting input an integrator can be realized. Depending on the type of feedback we get the following behaviour:</p>
<ul>
<li>Series-Shunt Feedback: Voltage Amplification</li>
<li>Shunt-Shunt Feedback: Transimpedance Amplification</li>
<li>Shunt-Series Feedback: Current Amplification</li>
<li>Series-Series Feedback: Transconductance Amplification</li>
</ul>
<p>The Amplification for these variants can be described by the following ratios:</p>
<ul>
<li><span class="math inline">\(A_{va} = \frac{v_{out}}{v_{in}}\)</span></li>
<li><span class="math inline">\(A_{tia} = \frac{v_{out}}{i_{in}}\)</span></li>
<li><span class="math inline">\(A_{ca} = \frac{i_{out}}{i_{in}}\)</span></li>
<li><span class="math inline">\(A_{tca} = \frac{i_{out}}{v_{out}}\)</span></li>
</ul>
<p>Capacitors in the feedback path or at the inputs create frequency dependant behaviour like filters. Without any feedback the OpAmp amplifies the differential input voltage with it’s open-loop gain <span class="math inline">\(A_{OL}\)</span>. The output voltage in this case can be calculated by the following formula:</p>
<p><span class="math display">\[
V_{out} = A_{OL} \cdot (V_{inv} - V_{ninv}) = A_{OL}V_{diff} \tag{26}
\]</span></p>
<p>The open-loop configuration is mostly used in comparators, because here we usually want the output of the OpAmp to saturate to the supply voltage <span class="math inline">\(V_{DD}\)</span> or negative supply <span class="math inline">\(V_{SS}\)</span> ground potential. This happens because the smallest deviation at the input of the amplifier is in most cases enough to drive the output to the supply voltage or ground since in real operational amplifiers the open-loop gain is usually in the range of ten thousand to a few hundred thousands. In ideal OpAmps this value is infinite. Other metrics of the OpAmp are the input impedance <span class="math inline">\(z_{in}\)</span>, the output impedance <span class="math inline">\(z_{out}\)</span>, the input offset voltage <span class="math inline">\(v_{os}\)</span> and input offset current which ultimately limit the performance. <span class="citation" data-cites="Gift2022">(<a href="../elie4/index.html#ref-Gift2022" role="doc-biblioref">Gift, Stephan J. G. and Maundy, Brent 2022</a>)</span></p>
<p>The following table illustrates the metrics and gives examples for different technologies (added frequency ranges):</p>
<table class="caption-top table">
<caption><strong>Comparison of different OpAmp semiconductor types vs.&nbsp;ideal OpAmps </strong> <span class="citation" data-cites="Gift2022">(<a href="../elie4/index.html#ref-Gift2022" role="doc-biblioref">Gift, Stephan J. G. and Maundy, Brent 2022</a>)</span>.</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Bipolar</th>
<th>JFET</th>
<th>CMOS</th>
<th>Ideal OpAmp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(z_{in}\)</span></td>
<td>$ 6 M $</td>
<td><span class="math inline">\(10^{13} \Omega\)</span></td>
<td><span class="math inline">\(10^{12} \Omega\)</span></td>
<td><span class="math inline">\(\infty\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(z_{out}\)</span></td>
<td><span class="math inline">\(\leq 100 \Omega\)</span></td>
<td><span class="math inline">\(\leq 100 \Omega\)</span></td>
<td><span class="math inline">\(\leq 100 \Omega\)</span></td>
<td><span class="math inline">\(0\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_{OL}\)</span></td>
<td><span class="math inline">\(10^3 - 10^6\)</span></td>
<td><span class="math inline">\(10^3 - 10^6\)</span></td>
<td><span class="math inline">\(10^3 - 10^6\)</span></td>
<td><span class="math inline">\(\infty\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(i_{off}\)</span></td>
<td><span class="math inline">\(\pm 40 \mu A\)</span></td>
<td><span class="math inline">\(\pm 1 pA\)</span></td>
<td><span class="math inline">\(\leq 1 pA\)</span></td>
<td><span class="math inline">\(0 A\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(v_{os}\)</span></td>
<td><span class="math inline">\(\approx 25 \mu V\)</span></td>
<td><span class="math inline">\(\approx 5 mV\)</span></td>
<td><span class="math inline">\(\approx 1 - 50 \mu V\)</span></td>
<td><span class="math inline">\(0\ V\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(f_{max}\)</span></td>
<td><span class="math inline">\(1 - 500 MHz\)</span></td>
<td><span class="math inline">\(100 kHz - 30 MHz\)</span></td>
<td><span class="math inline">\(10 kHz - 100 MHz\)</span></td>
<td><span class="math inline">\(\infty\)</span></td>
</tr>
</tbody>
</table>
<p>The components described at the beginning of this chapter are needed to implement the incremental delta-sigma converter and later the analog-to-digital converter. But not all of these components need the functionality modern OpAmps have. They for example don’t necessarily need current-limiting or rail-to-rail outputs, they don’t need very high bandwidths or other features.</p>
<p>Here in IC design and ultimately in chip level circuit design we need to carefully balance the trade-offs between power consumption, bandwidth and chip area. In the following chapter we will see that for this balance or rather operation type between power or area efficiency and frequency range we need to design our circuits for certain qualities. Here we want to note that every single square-milimeter of area on the die is costly and therefore careful design is required. To give an example the price per <span class="math inline">\(mm^2\)</span> for the IHP-SG13G2 PDK we’re also using in this project is 7300€. (as of March 2025)<span class="citation" data-cites="IHP-Pricing">(<a href="../elie4/index.html#ref-IHP-Pricing" role="doc-biblioref">IHP GmbH 2025</a>)</span></p>
</section>
<section id="gmid---methodology" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="gmid---methodology"><span class="header-section-number">12.2</span> gm/ID - Methodology</h2>
<p>One of the first questions we have to ask in IC design is how small or how large we can design the MOSFETs we’re using in the circuits. MOSFETs can be used in saturation mode or in the triode state (as well as in cut-off but this is not relevant for us). When the FET is in saturation the drain current <span class="math inline">\(I_{D}\)</span> is controlled primarily by the gate-source voltage <span class="math inline">\(V_{GS}\)</span>. In this case the drain-source voltage has a smaller impact on the drain current. For the Transistor to work in saturation the drain-source terminals need to be driven with a voltage high enough so this “saturates” the FET and the highest drain-current is achieved.</p>
<p>On the other hand if the voltage applied across the drain-source contacts (on a NMOS for example) is relatively low (compared to the voltage for saturation), the FET will operate in the so called triode mode. In triode mode the drain-source voltage <span class="math inline">\(V_{DS}\)</span> has a fundamentally larger impact on the drain current then in the saturation mode. <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span></p>
<p>One Methodology to solve the question we asked at the beginning of this chapter is the <span class="math inline">\(\frac{gm}{I_{D}}\)</span> methodology which we will introduce in a moment. There are basically three MOSFET characteristics directly describing the behaviour of it:</p>
<ul>
<li><span class="math inline">\(\frac{g_m}{I_D}\)</span> : Transconductance Efficiency</li>
<li><span class="math inline">\(\frac{\omega_{T}}{f_T}\)</span> : Transit frequency</li>
<li><span class="math inline">\(\frac{g_m}{g_{ds}}\)</span> : Intrinsic Gain</li>
</ul>
<p>To understand the first characteristic for our FETs we have to take a look at the different operating points which depend on the applied voltages. Whenever we apply voltages to a FET in order to control a specific drain current <span class="math inline">\(I_{D}\)</span>, we can operate the FET in either weak inversion, strong inversion or moderate inversion. This behaviour is controlled by the Overdrive Voltage <span class="math inline">\(V_{OV}\)</span> which is defined as the difference between the gate-source voltage and the threshold voltage. To note this small point the drain-current is controlled by the voltage between gate and source. Whenever an nmos is not being used as a low-side switch or amplifier or the pmos is being used as a low-side component problems can arise. Since we are using FETs in our switched capacitor integrator for example this is quite important.</p>
<p><span class="math display">\[
    V_{OV} = V_{GS} - V_{TH} \tag{27}
\]</span></p>
<p>We have to keep in mind that the threshold voltage isn’t a magical number that can be applied to every MOSFET, it rather depends on the geometry (with W and L for example) and other factors. For the example nmos given in the Analog Circuit Design IHP SG13G2 Devices Table by Professor Pretl, the threshold voltage is 0.5V. Therefore the overdrive voltage describes how “much” the gate-source voltage is above the threshold of the FET. Depending on this overdrive voltage the circuit/ic designer can apply different <span class="math inline">\(\frac{g_{M}}{I_{D}}\)</span> values with the unit [<span class="math inline">\(\frac{1}{V}\)</span>]. This unit is derived in the following way:</p>
<p>With <span class="math inline">\(g_{M}\)</span> defined by:</p>
<p><span class="math display">\[
g_{M} = \frac{\partial I_D}{\partial V_{GS}}  \tag{28}
\]</span></p>
<p>and <span class="math inline">\(I_{D}\)</span> having the unit Ampere [A] and the voltage <span class="math inline">\(V_{GS}\)</span> we get:</p>
<p><span class="math display">\[
\frac{\frac{A}{V}}{A} = \frac{1}{V} \tag{29}
\]</span></p>
<p>Before we continue with the <span class="math inline">\(\frac{g_{M}}{I_{D}}\)</span> method we want to note that there also is the <em>square-law</em> model with which circuit designers can design MOSFET circuits. This model is usually applicable for PCB circuits and takes the situation into account where the MOSFET is driven in the stong inversion state. The square-law model is being applied assuming that the FET is operating in the “linear” or “triode” mode, however on nanometer scale FETs (down to 130 nm with the IHP-SG13G2 PDK) this model doesn’t give us precise solutions anymore. Many effects like parasitic capacitances alter the operational behaviour of the FET and lead to the square-law model deviating afar from the real-world behaviour in many situations <span class="citation" data-cites="SQRLaw">(<a href="../elie4/index.html#ref-SQRLaw" role="doc-biblioref">Alan Doolittle 2025</a>)</span>.</p>
<p>The square-model drain-current behavior is being described by the following formula:</p>
<p><span class="math display">\[
I_{D} = \frac{Z \cdot \overline{\mu_n} \cdot C_{OX}}{L} [(V_{GS} - V_{T}) \cdot V_{DS} - \frac{V_{DS}^2}{2}]  \tag{30}
\]</span></p>
<p>with the two conditions:</p>
<p><span class="math inline">\(0 \leq V_{DS} \leq V_{D_{SAT}}\)</span> and <span class="math inline">\(V_{GS} \geq V_T\)</span></p>
<p>with following definitions:</p>
<ul>
<li><span class="math inline">\(C_{OX} = \frac{\epsilon_{ox}}{x_{ox}}\)</span></li>
<li>Z = MOSFET width</li>
<li>L = MOSFET Channel length</li>
<li><span class="math inline">\(V_T\)</span> = Threshold voltage</li>
<li><span class="math inline">\(\overline{\mu_n}\)</span> = effective electron mobility</li>
</ul>
<p>The threshold voltage is defined as:</p>
<p><span class="math display">\[
V_T = 2 \phi_F + \frac{\epsilon_s}{C_{OX}} \sqrt{\frac{2q N_{A}}{\epsilon} (2\phi_F)} \tag{31}
\]</span></p>
<p>with:</p>
<p><span class="math inline">\(\phi_F\)</span> being the Fermi Potential (surface potential) defined by:</p>
<p><span class="math display">\[
\phi_F = \frac{kT}{q} \cdot ln (\frac{N_A}{n_i}) \tag{32}
\]</span></p>
<p>with <span class="math inline">\(N_A\)</span> being the acceptor doping concentration and <span class="math inline">\(n_i\)</span> being the intrinsic carrier concentration. The term 2 <span class="math inline">\(\phi_F\)</span> corresponds to the surface potential required to achieve strong inversion.</p>
<p>For more details the reader can consult <span class="citation" data-cites="SQRLaw">(<a href="../elie4/index.html#ref-SQRLaw" role="doc-biblioref">Alan Doolittle 2025</a>)</span>,<span class="citation" data-cites="MurmannGmId">(<a href="../elie4/index.html#ref-MurmannGmId" role="doc-biblioref">Boris Murmann 2016</a>)</span> or <span class="citation" data-cites="gmId">(<a href="../elie4/index.html#ref-gmId" role="doc-biblioref">Silveira, Flandre, and Jespers 1996</a>)</span>.</p>
<p>To illustrate the problems of the square-law model when designing MOSFET circuits at nanometer scale we will look at some graphs visualizing it’s limitation. First of all let’s look at the formulas for the square-law when we want to achieve more performance with our FETs:</p>
<p>Transconductance Efficiency: <span class="math display">\[
\frac{g_m}{I_D} \cong \frac{2}{V_{OV}} \tag{33}
\]</span></p>
<p>higher efficiencs here means more transconductance for the same drain current.</p>
<p>Transit Frequency:</p>
<p><span class="math display">\[
\frac{g_M}{C_{gg}} \cong \frac{3}{2}\frac{\mu V_{OV}}{L^2} \tag{34}
\]</span></p>
<p>higher transit frequency for the same gate-capacitance.</p>
<p>Intrinsic Gain:</p>
<p><span class="math display">\[
\frac{g_m}{g_{ds}} \cong \frac{2}{\lambda V_{OV}} \tag{35}
\]</span></p>
<p>high transconductance (at same drain-current <span class="math inline">\(I_D\)</span>) without higher output conductance.</p>
<p>The square-law model completely fails in these cases when the MOSFET is not operation in strong inversion. In moderate and weak inversion we are forced to use a different mathmatical model , and the <span class="math inline">\(\frac{g_M}{I_D}\)</span> method is a really good starting point <span class="citation" data-cites="RWalker">(<a href="../elie4/index.html#ref-RWalker" role="doc-biblioref">Ross Walker 2017</a>)</span>.</p>
<p>The following figures will show the deviation between square-law and measurements as well as the <span class="math inline">\(\frac{g_M}{I_D}\)</span> methodology:</p>
<p>So first of all when we use <span class="math inline">\(g_M\)</span> and <span class="math inline">\(I_D\)</span> we specify that for a specific drain-current we get a specific transconductance, for example with a <span class="math inline">\(\frac{g_M}{I_D}\)</span> of 10 S/A we get 10 <span class="math inline">\(\mu\)</span> S per 1 <span class="math inline">\(\mu\)</span> A of bias current. And depending on how “much” the transistor is operating above it’s threshold voltage <span class="math inline">\(V_{th}\)</span> (basically the Overdrive Voltage <span class="math inline">\(V_{OV}\)</span> ) you get different inversion levels. From weak inveresions for low overdrive voltages to moderate inversion when operating at approximately <span class="math inline">\(V_{OV}\)</span> = <span class="math inline">\(V_{th}\)</span> to high inversion when <span class="math inline">\(V_{OV}\)</span> &gt; <span class="math inline">\(V_{th}\)</span>.</p>
<p>With the square-law value for transconductance efficiency we completely deviate with that approximation in weak and moderate inversion:</p>
<div id="fig-inversion-vs-vov" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inversion-vs-vov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_inversion_vs_vov.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inversion-vs-vov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.1: Inversion level vs.&nbsp;Overdrive Voltage <span class="citation" data-cites="RWalker">(<a href="../elie4/index.html#ref-RWalker" role="doc-biblioref">Ross Walker 2017</a>)</span>
</figcaption>
</figure>
</div>
<p>Another deviation from square-law to real MOSFET behaviour can be seen when we increase the gate-source voltage of the FET and measure the drain-current. According to square-law formual for the drain-current the current should just increase to the square with increasing gate-source voltage. But by taking the square of the drain-current and increasing <span class="math inline">\(V_{GS}\)</span> we can see that the drain-current does not magically start flowing above the threshold-voltage and also the behaviour is also not linear (quadratically when not taking the square of the current):</p>
<div id="fig-id_vs_gs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-id_vs_gs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_id_vs_gs.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-id_vs_gs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.2: Drain Current over Gate-Source Voltage, Simulation vs.&nbsp;square-law <span class="citation" data-cites="RWalker">(<a href="../elie4/index.html#ref-RWalker" role="doc-biblioref">Ross Walker 2017</a>)</span>
</figcaption>
</figure>
</div>
<p>This simulation is done for a n-channel MOSFET with a drain-source voltage of 1.8 V and a size of L = 180 nm and W = 5 <span class="math inline">\(\mu\)</span>m.</p>
<p>The drain-current behaviour at sub-threshold gate voltages is completely inaccurate for the square-law too, and the following graph visualizes the limitation of the square-law at this point again:</p>
<div id="fig-gmid_vs_gs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gmid_vs_gs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_gmid_vs_gs.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gmid_vs_gs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.3: Drain Current over Gate-Source Voltage, comparison between an nmos, a bjt and the square-law <span class="citation" data-cites="RWalker">(<a href="../elie4/index.html#ref-RWalker" role="doc-biblioref">Ross Walker 2017</a>)</span>
</figcaption>
</figure>
</div>
<p>These three examples show that the approach using square-law to size MOSFETs is not sufficient when the transistor is operating in weak or moderate inversion and when driving the FET (nmos for example) with a low gate-source (or overdrive-) voltage. To cite Mr.&nbsp;Walker on this topic: “This means that the square law equation (which assumes 100% drift current) does not work unless the gate overdrive is several <span class="math inline">\(\frac{kT}{q}\)</span>, <span class="citation" data-cites="RWalker">(<a href="../elie4/index.html#ref-RWalker" role="doc-biblioref">Ross Walker 2017</a>)</span>”.</p>
<p>To conclude this, we can keep in mind that there is no simple formula that can describe the drain-current behaviour in all situations and be universally used. So using the <span class="math inline">\(\frac{g_m}{I_D}\)</span> methodology is the way to go in our project.</p>
<p>Now with that out of the way we can design our circuits using the <span class="math inline">\(\frac{g_m}{I_D}\)</span> methodology. The main properties of our MOSFETs we can manipulate in xschem are the lenght of the channel L, the width W and the bias current <span class="math inline">\(I_D\)</span>. The common way to use this method is to first characterize nmos and pmos field effect transistors and then use this data to design the circuits. In the chapter “MOSFET characterization Testbench” chapter in <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span> we can see how the values for the <span class="math inline">\(\frac{g_m}{I_D}\)</span> methodology are being simulated for later use.</p>
<p>The lenght of the MOSFET channel also has a large influence on it’s frequency characteristic as it can be seen in this simulation:</p>
<div id="fig-ft_vs_L" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ft_vs_L-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_ft_vs_L.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ft_vs_L-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.4: transit frequency vs.&nbsp;channel length L <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span>
</figcaption>
</figure>
</div>
<p>The operating areas of interest for us are the saturation region (when using the FET as an amplifier for example) and the region when the FET is being used to “just” work as a switch. With setting <span class="math inline">\(V_{DS}\)</span> to <span class="math inline">\(\frac{V_{DD}}{2}\)</span> we keep the FET in saturation. Reminding ourselves again that with larger <span class="math inline">\(g_M\)</span> we have more “gain” and with a smaller <span class="math inline">\(I_D\)</span> we have higher efficiency we try to hit the sweetspot between size (as every square milimeter has it’s cost) and current consumption (if we have wearable battery powered devices for example). Keeping also in mind that temperature has a large effect we cannot use arbitratily large drain currents.</p>
<p>Following plot visualizes the dependancy of <span class="math inline">\(\frac{g_M}{I_D}\)</span> to the gate-source voltage and shows the transit frequency behaviour too:</p>
<div id="fig-gm_vs_gs_vs_ft" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gm_vs_gs_vs_ft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_ft_vs_gm_vgs.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gm_vs_gs_vs_ft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.5: <span class="math inline">\(\frac{g_M}{I_D}\)</span> and <span class="math inline">\(f_T\)</span> over the gate-source voltage <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span>
</figcaption>
</figure>
</div>
</section>
<section id="subcomponents-systems-of-the-incremental-delta-sigma-modulator" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="subcomponents-systems-of-the-incremental-delta-sigma-modulator"><span class="header-section-number">12.3</span> Subcomponents/-systems of the incremental Delta-Sigma Modulator</h2>
<p>Our incremental <span class="math inline">\(\Delta \Sigma\)</span>-Modulator is made up of different clocked non-clocked components. To have a working converter at the end we first build the circuit according to circuits from Professor Pretl and also made use of several circuits which were proved functional from different IEEE publications and other references from literature. Another important source of knowledge were the lecture slides of Professor Boris Murmann from the University of Hawai’i at Mānoa from the lecture: EE 628 - Analysis and Design of Integrated Circuits, which can be found here: <span class="citation" data-cites="EE628">(<a href="../elie4/index.html#ref-EE628" role="doc-biblioref">Boris Murmann 2024</a>)</span>.</p>
<section id="voltage-reference" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="voltage-reference"><span class="header-section-number">12.3.1</span> Voltage Reference</h3>
<p>The first circuit we want to take a look at is the voltage reference in our delta-sigma modulator. The comparator in the delta-sigma converter compares the output voltage of the integrator to the reference voltage and outputs a high- or low-signal (depending on the circuit for example 1.2 V or 0 V). So to set a voltage to which the output of the integrator can be compared against we utilize a bandgap-reference to generate our output voltage. In the case where the reference voltage is not ground this circuit will be used.</p>
<p>Another reason to use a voltage-reference is to create the biasing-currents used to drive the 5T-OTA and other circuits where we need a current to shift the voltages (and currents) in a way to the MOSFETs are at their biasing-point (20 <span class="math inline">\(\mu\)</span> A for example at the OTA).</p>
<p>The bandgap-reference utilizes the base-emitter voltage <span class="math inline">\(V_{BE}\)</span> of bipolar junction transistors. In the IHP-SG13G2 pdk we can implement the needed pnp-layers and therefore use the badgap-voltage <span class="math inline">\(V_{g0}\)</span> of silicon which is 1.205 V at 0 K. Even tho, as can be seen from the bandgap-voltage <span class="math inline">\(V_{g0}\)</span>, this voltage is temperature dependant, by using two BJTs with different current densities we can generate a refernce voltage that is indepentant of the temperature. The full equasion for the <span class="math inline">\(V_{ref}\)</span> is:</p>
<p><span class="math display">\[
V_{ref} = V_{g0} (1-\frac{T}{T_0}) + V_{BE0}(\frac{T}{T_0}) + \frac{kT}{q} ln(\frac{J1}{J2}) \tag{36}
\]</span></p>
<p>with J1 and J2 being the differnet emitter current densities.</p>
<p>The improvised BJTs don’t have great specs regarding speed and other performance metrics, but this implementation can reach accuracies of <span class="math inline">\(\pm\)</span> 1 to 3 % <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span>.</p>
<div id="fig-ac_simple_bandgap" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_simple_bandgap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_simple_bandgap.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_simple_bandgap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.6: Bandgap Reference Circuit <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span>
</figcaption>
</figure>
</div>
<p>With the two Resistors R1 and R2 in this circuit we were able to change the reference voltage at the output. The output voltage <span class="math inline">\(V_{ref}\)</span> can be calculated by the following formula:</p>
<p><span class="math display">\[
V_{ref} = V_{BE} + \frac{R2}{R1} \frac{kT}{q} ln(m) \tag{37}
\]</span></p>
<p>Our implementation in xschem looks like this:</p>
<div id="fig-ac_eaa_vref_sch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_vref_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_vref_sch.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_vref_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.7: Our Bandgap Reference Circuit
</figcaption>
</figure>
</div>
<p>Using the formula we changed the resistors R1 and R2 to get a reference voltage of 729 mV. This voltage was used to see how much we can change the reference voltage. In the application we use the half of the supply voltage for the comparator reference and according voltages for the biasing currents for the MOSFET circuits like the OTA.</p>
<p>Following picture shows the output voltage over time:</p>
<div id="fig-ac_eaa_vref_tran" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_vref_tran-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_vref_tran.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_vref_tran-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.8: Our Bandgap Reference Voltage, transient simulation
</figcaption>
</figure>
</div>
<p>Even tho the temperature dependencies canceled out each other in the formuals above, second-order effects still lead to some voltage variation over temperature <span class="citation" data-cites="hpretlacd">(<a href="../elie4/index.html#ref-hpretlacd" role="doc-biblioref">H. Pretl and Michael Koefinger 2025</a>)</span>. The next picture graph shows the temperature sensitivity of our voltage-reference:</p>
<div id="fig-ac_eaa_vref_temp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_vref_temp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_vref_temp.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_vref_temp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.9: Bandgap reference voltage over temperature
</figcaption>
</figure>
</div>
</section>
<section id="voltage-controlled-ring-oscillator" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="voltage-controlled-ring-oscillator"><span class="header-section-number">12.3.2</span> Voltage Controlled Ring Oscillator</h3>
<p>Another important circuit is the Oscillator which is ultimately used to create the system clock. The system clock can be transferred to all circuit elements which need to switch like the switched-capacitor integrator or reset-circuitry to start a new integration cycle. This clock generator ensures together with the clock-splitter that all circuits are synchronized to each other (keep in mind that clock shall never overlap when there are FETs connected in series, or otherwise there can be dead-shorts from <span class="math inline">\(V_{DD}\)</span> to ground).</p>
<p>The basic building blocks of our ring oscillator are the inverters working as delay stages (plays an important role for the frequency). Each stage has a specific delay and in total multiple stages cascaded need to have a total phase shift of 2 <span class="math inline">\(\pi\)</span> or 360°. They also need to have a voltage gain of one at the oscillation frequency. With each stage having a gain of:</p>
<p><span class="math display">\[
A(j\omega) \tag{38}
\]</span></p>
<p>we get the gain of each stage:</p>
<p><span class="math display">\[
A_1(j\omega) = A_2(j\omega) = A_3(j\omega) = \frac{-g_MR}{1 + j\omega RC} \tag{39}
\]</span></p>
<p>Since we have an odd number of stages (N) every stage of the inverters needs to provide <span class="math inline">\(\frac{\pi}{N}\)</span> phase shift so that with the dc-inversion at the end of the ring (adds another phase-shift of <span class="math inline">\(\pi\)</span> or 180°) we can fulfill the Barkhausen criterion and our circuit will oscillate:</p>
<p><span class="math display">\[
|A_1(j\omega) \cdot A_2(j\omega) \cdot A_3(j\omega)| = 1 \tag{40}
\]</span></p>
<p>The R’s and C’s are coming from the input capacitances of the FETs and are modeled in the formula as being the loads to the transconductances of each stage.</p>
<p>With each stage having a phase-shift of:</p>
<p><span class="math display">\[
\angle A(j\omega) = \theta = arctan (\omega RC) = \frac{2 k \pi}{N} \tag{41}
\]</span></p>
<p>we get an oscillation frequency of:</p>
<p><span class="math display">\[
\omega_0 = \frac{tan (\theta)}{RC} \tag{42}
\]</span></p>
<p>or with the time-delay <span class="math inline">\(t_d\)</span> of each stage:</p>
<p><span class="math display">\[
f = \frac{1}{2Nt_d} \tag{43}
\]</span></p>
<p>Since in our application we want to have a period of 4.5 <span class="math inline">\(\mu s\)</span> we need a oscillation frequency of</p>
<p><span class="math display">\[
f_{osc} = \frac{1}{4.5 \mu s} = 222.2222 kHz
\]</span></p>
<p>and we have three stages, we need to have a delay of:</p>
<p><span class="math display">\[
t_d = \frac{1}{2Nf_{osc}} = \frac{1}{2\cdot3\cdot222.22 kHz} = 75 \mu s
\]</span></p>
<p>In our implementation of the ring oscillator we are intentionally using the voltage controlled (VCO) oscillator. The inverter stages are biased by the current sources which are fed by the MOSFETs M11, M13, M15 and M16. Here we are limiting the biasing current and we can control this current through the voltage applied to the FET M17. This voltage then controls the current and ultimately the delay of each inverter which in turn allows us to change the frequency of our oscillator. The following pictures illustrate our oscillator circuit and additional circuitry:</p>
<div id="fig-ac_eaa_ring_osc_sch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_ring_osc_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_ring_osc_sch.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_ring_osc_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.10: Ring-Oscillator implemented in xschem
</figcaption>
</figure>
</div>
<p>In the middle part of the circuit we can see the three inverter stages. These are supplied by the four MOSFETs at the edges with current which is in turn controlled by the voltage applied to the nmos on the left-hand side <span class="citation" data-cites="vcoring">(<a href="../elie4/index.html#ref-vcoring" role="doc-biblioref">G. Jovanovic and Stamenkovic 2010</a>)</span>. After implementing multiple different oscillator circuits this was the one that finally oscillated:</p>
<div id="fig-ac_eaa_ring_osc_out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_ring_osc_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_ring_osc_out.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_ring_osc_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.11: Ring-Oscillator output voltage
</figcaption>
</figure>
</div>
<p>We can see in this plot that after around 10 <span class="math inline">\(\mu\)</span>s the circuit starts to oscillate. This is a sinusodial oscillation and since we need a rectangular clock signal we implemented a schmitt-trigger circuit after the oscillator in order to get a PWM signal with a duty cycle of 0.5 and a frequency of 222 kHz. The Schmitt-Trigger circuit looks like this <span class="citation" data-cites="schmitt">(<a href="../elie4/index.html#ref-schmitt" role="doc-biblioref">Filanovsky and Baltes 2004</a>)</span>:</p>
<div id="fig-ac_eaa_schmitt_w" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_schmitt_w-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_schmitt_sch_w.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_schmitt_w-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.12: Schmitt-Trigger
</figcaption>
</figure>
</div>
<p>Whenever the input signal of the schmitt-trigger crosses a set limit the output is pulled to a high state. And if the input signal falls below a certain threshold the output signal goes low again. This transfer function is visualizes in this graph:</p>
<div id="fig-ac_eaa_schmitt_curve" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_schmitt_curve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_schmitt_curve.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_schmitt_curve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.13: Schmitt-Trigger, <span class="citation" data-cites="schmittcurve">(<a href="../elie4/index.html#ref-schmittcurve" role="doc-biblioref">Allelco 2025</a>)</span>
</figcaption>
</figure>
</div>
<p>Unfortunately the output of our schmitt-trigger stayed low at all times so we assume that the setpoints for the change of the states from high to low and from low to high were not set correctly.</p>
<p>To see if the clock signal from the VCO at least has the right frequency we plotted a reference clock-signal and compared both of them:</p>
<div id="fig-ac_eaa_osc_vs_ref" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_osc_vs_ref-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_ring_osc_vs_ref.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_osc_vs_ref-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.14: VCO Signal compared to a reference clock signal with , <span class="citation" data-cites="schmittcurve">(<a href="../elie4/index.html#ref-schmittcurve" role="doc-biblioref">Allelco 2025</a>)</span>
</figcaption>
</figure>
</div>
<p>As can be seen from this plot there’s only a slight difference in frequency and this can be easily compensated by the control-voltage of the VCO.</p>
</section>
<section id="clock-generatorsplitter-with-delay-circuit" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="clock-generatorsplitter-with-delay-circuit"><span class="header-section-number">12.3.3</span> Clock Generator/Splitter with delay circuit</h3>
<p>Now assuming we have a clean clocking signal we need to split this clock into two non-overlapping clock signals so the switched-capacitor integrator stage and the other circuit elements can be clocked. Our clock splitter circuit is a circuit based on the given splitter in the lecture number 13 from <span class="citation" data-cites="EE628">(<a href="../elie4/index.html#ref-EE628" role="doc-biblioref">Boris Murmann 2024</a>)</span> the lectures of Professor Murmann. This in turn is a circuit designed in the Ph. D. Thesis of Dr.&nbsp;Andrew Abo and utilizes inverters and nand-gates to generate four output signals from the one input clock. These four clock-signals come in pairs of two, so two clock signals which are inverted to each other and then another two signals which have a slightly larger delay (or dead-time) in between them ensuring no overlapping. We implemented this circuit not only using logic gates like the mentioned inverters and nand-gates but also transistorized this circuit.</p>
<p>Each inverter in our Clock-Splitter looks like this:</p>
<div id="fig-ac_eaa_inverter" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_inverter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_inverter.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_inverter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.15: Inverter for our Clock-Splitter
</figcaption>
</figure>
</div>
<p>And we also implemented nand gates with nmos and pmos FETs and added an output driving stage for each nand gate:</p>
<div id="fig-ac_eaa_nand" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_nand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_nand.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_nand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.16: NAND-Gate with output driving stage
</figcaption>
</figure>
</div>
<p>Before continueing with the circuit design we simulated the nand gate to ensure that it operated as we intended. For that we applied clocked signals and checked whether the gate output was low whenever both signal input signals were high and vice versa or not:</p>
<div id="fig-ac_eaa_nand_in" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_nand_in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_nand_in.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_nand_in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.17: Input Signals [V] at the two inputs of the NAND Gate
</figcaption>
</figure>
</div>
<div id="fig-ac_eaa_nand_out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_nand_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_nand_out.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_nand_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.18: Output Voltage of the NAND Gate
</figcaption>
</figure>
</div>
<p>From these simulations we can see that the nand gate is working.</p>
<p>Now let’s continue with the complete circuit:</p>
<div id="fig-ac_eaa_clocksplitter_logic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_clocksplitter_logic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_clksplitter_logic.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_clocksplitter_logic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.19: Clocksplitter from Dr.&nbsp;Andrew Abo <span class="citation" data-cites="aabo">(<a href="../elie4/index.html#ref-aabo" role="doc-biblioref">Dr. Andrew Masami Abo 1992</a>)</span>
</figcaption>
</figure>
</div>
<p>Starting from this we implemented the inverters and nand gates with discrete MOSFETs and designed a testbench in xschem:</p>
<div id="fig-ac_eaa_clocksplitter" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_clocksplitter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_clksplitter.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_clocksplitter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.20: Clocksplitter implemented with n- and pmos FETs from IHP-SG13G2 PDK
</figcaption>
</figure>
</div>
<p>Below you can see the setup for the simulation. The input is fed by a clock signal with a period time of 4.5 <span class="math inline">\(\mu\)</span> s:</p>
<div id="fig-ac_eaa_clocksplitter_simsetup" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_clocksplitter_simsetup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_clksplitter_simsetup.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_clocksplitter_simsetup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.21: Simulation setup for the clocksplitter in xschem
</figcaption>
</figure>
</div>
<p>Now let’s look at the outputs:</p>
<div id="fig-ac_eaa_clocksplitter_out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_clocksplitter_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_clksplitter_out.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_clocksplitter_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.22: Clock Phases from our Clocksplitter
</figcaption>
</figure>
</div>
<p>We can see that the clock-signal edges have some overshoot and ringing. This is a point at which the clock splitter circuit should be further optimized.</p>
</section>
<section id="inverter-as-integrator" class="level3" data-number="12.3.4">
<h3 data-number="12.3.4" class="anchored" data-anchor-id="inverter-as-integrator"><span class="header-section-number">12.3.4</span> Inverter as Integrator</h3>
<p>While we could use an operational transconductance amplifier at the heart of our SC-Integrator we implemented an inverter as the core of the integrator. Inverters can be used since the main goal of the integrator stage is to transfer the charge from the sample capacitor <span class="math inline">\(C_s\)</span> and integrate it with the help of the integration capacitor <span class="math inline">\(C_i\)</span>. For this operation the inverter is enough and we utilize it here. Another drawback with using an OTA or an OpAmp for the integrator is the additional power consumption and area. Additional informations regarding the inverter as an integrator can be found here: <span class="citation" data-cites="cmosadc">(<a href="../elie4/index.html#ref-cmosadc" role="doc-biblioref">Chae et al. 2011</a>)</span>.</p>
<p>Our implementation in xschem looks like this:</p>
<div id="fig-ac_eaa_inv_int" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_inv_int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_inv_int.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_inv_int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.23: Inverter in our first order idsm
</figcaption>
</figure>
</div>
<p>In this Figure we can see three capacitors. Usually we have two capacitors in the SC-Integrator but in this schematic we have a third one. While we know the input capacitor being the sampling capacitor <span class="math inline">\(C_S\)</span> and the integrating capacitor <span class="math inline">\(C_I\)</span> the third capacitor after <span class="math inline">\(C_S\)</span> is the holding capacitor <span class="math inline">\(C_H\)</span> which holds the charge from the input capacitor for further processing. Also the switches aren’t yet transistorized. But for now lets look at the outputs of this circuit and the clock signals:</p>
<div id="fig-ac_eaa_inv_int_plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_inv_int_plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_inv_int_plot.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_inv_int_plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.24: Inverter output
</figcaption>
</figure>
</div>
<p>We can see that the voltage after the inverter working as an integrator rises. With the constant input voltage at the input this means that our integrator is indeed working. But the other signals are not correct yet since for example q would need to be a PCM signal.</p>
<p>The clocking signals are as shown:</p>
<div id="fig-ac_eaa_inv_int_clk" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_inv_int_clk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_inv_int_clk.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_inv_int_clk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.25: Clocking signals
</figcaption>
</figure>
</div>
<p>The values for the mentioned three capacitors are as follows:</p>
<ul>
<li><span class="math inline">\(C_S\)</span> = 1 pF</li>
<li><span class="math inline">\(C_H\)</span> = 1 pF</li>
<li><span class="math inline">\(C_I\)</span> = 2 pF</li>
</ul>
</section>
<section id="clocked-comparator" class="level3" data-number="12.3.5">
<h3 data-number="12.3.5" class="anchored" data-anchor-id="clocked-comparator"><span class="header-section-number">12.3.5</span> Clocked Comparator</h3>
<p>Another important subcircuit is the clocked comparator. The output of our integrator is fed into the comparator and being compared to eiter half of the supply voltage <span class="math inline">\(V_{DD}\)</span> or to 0 V. After the comparator the voltage signal is now digital (since the comparator only puts our high or low) and this signal is further processed for the feedback with the 1-Bit DAC and the digital filter and decimator.</p>
<p>For our implementation of the comparator and latch we used the StrongARM latch which was utilized in the StrongARM microprocessor from Digital Equipment Corporation. The fundamental circuit was originally introduced by Kobayashi et al.&nbsp;from Toshiba <span class="citation" data-cites="strongARM">(<a href="../elie4/index.html#ref-strongARM" role="doc-biblioref">Razavi 2015</a>)</span>. This circuit consists of a differential pair, two cross-coupled pairs and four precharge switches. By applying the clock signal to the comparator we can compare the inputs of the comparator and provide a clocked output as opposed to “classical” comparators which output their states continuesly.</p>
<div id="fig-ac_eaa_comparator" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_comparator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_comparator.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_comparator-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.26: StrongARM Comparator
</figcaption>
</figure>
</div>
<p>After the comparison stage we latch the output and store it until in the next clock cycle the comparison happens again. This is the latching circuit after the comparator:</p>
<div id="fig-ac_eaa_comparator_latch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_comparator_latch.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.27: StrongARM Latch after the comparator
</figcaption>
</figure>
</div>
<p>As can be seen after the latching circuit we added an output driving stage again to ensure that our comparator can drive loads accordingly. We verified the functioality by applying signals to the input and plotting the output. Our comparator works as intended:</p>
<p>First lets see the input signal circuitry. We had to connect a resistor to the two positive input voltage sources because we wanted to skip one pulse at which then the voltage pulse at the negative input would be higher than the voltage of the positive input:</p>
<div id="fig-ac_eaa_comparator_latch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_comparator_vin.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.28: Input voltage circuitry
</figcaption>
</figure>
</div>
<div id="fig-ac_eaa_comparator_latch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_comparator_in.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.29: Input Signals at the two inputs of our comparator
</figcaption>
</figure>
</div>
<div id="fig-ac_eaa_comparator_latch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_comparator_out.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_comparator_latch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.30: Output signal and the clock signal
</figcaption>
</figure>
</div>
<p>We observe that whenever the negative input of the comparator is higher than the positive input the output goes low. Otherwise the output signal is high. This verifies the functionality of our StrongArm comparator and latch.</p>
</section>
<section id="bit-dac" class="level3" data-number="12.3.6">
<h3 data-number="12.3.6" class="anchored" data-anchor-id="bit-dac"><span class="header-section-number">12.3.6</span> 1-Bit DAC</h3>
<p>The last circuitry we want to take a look at is the 1-Bit DAC in the feedback path. This DAC is basically implemented as an inverter. Whenever the output of the comparator is a logical one the output of the DAC is a logical low or 0V. By connecting the inverter between <span class="math inline">\(V_{DD}\)</span>, GND and the input signal we can fulfill this functionality of it. A transmission gate is added to the input to switch the signal. This consists of two MOSFETs connected as complementary switch, a cmos. That circuitry looks like this:</p>
<div id="fig-ac_input_transmission_gate" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_input_transmission_gate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_input_transmission_gate.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_input_transmission_gate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.31: The transmission gate at the input
</figcaption>
</figure>
</div>
</section>
</section>
<section id="first-order-delta-sigma-modulator" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="first-order-delta-sigma-modulator"><span class="header-section-number">12.4</span> First Order Delta-Sigma Modulator</h2>
<p>Our methodology to implement the first-order delta-sigma modulator was to verifiy the functionality of each subcircuit and then implement this in a complete circuit. We first started by substituting the switches of the SC-Integrator by pmos- and nmos-FETs and then continued with the integrator which was implemented by an inverter and the integrating capacitor. Then we added the comparator and latching circuit after the integrator. After this was implemented we added our bandgap voltage-reference and the clock splitter. We then connected the four phases of our clock splitter to the FETs of the SC-Integrator as well as to the clocked-comparator. Unfortunately the first order idsm does not work yet and we suspect that there is a problem with the Sample- and Hold-Stage or with the SC-Integrator.</p>
<div id="fig-ac_eaa_sc_integrator_stage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_sc_integrator_stage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_sc_integrator_stage.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_sc_integrator_stage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.32: SC-Integrator Stage and transmission gate as well as 1-Bit DAC at the bottom left
</figcaption>
</figure>
</div>
<p>The following plot shows the different signals of the first order idsm:</p>
<div id="fig-ac_eaa_real_idsm1_out" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_real_idsm1_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_real_idsm1_out.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_real_idsm1_out-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.33: Output of our first order idsm
</figcaption>
</figure>
</div>
</section>
<section id="second-order-delta-sigma-modulator" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="second-order-delta-sigma-modulator"><span class="header-section-number">12.5</span> Second Order Delta-Sigma Modulator</h2>
<p>The second-order idsm has two integrators back to back as well as the feedback signal fed into the summing nodes twice. We would have implemented the second-order idsm once the first order circuit worked. As mentioned in the lecture slides by Professor Meiners it’s not so smart to try and find the error in the finalized circuit. We rather did what he suggested and verified the functionality of most of the circuits.</p>
<p>This picture is from the first order idsm but is should give the reader the understanding why errors are harder to fix when the circuit is combined and then harder to fix:</p>
<div id="fig-ac_eaa_complete_first_order" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ac_eaa_complete_first_order-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_eaa_complete_first_order.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ac_eaa_complete_first_order-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12.34: Schematic of our complete first order idsm
</figcaption>
</figure>
</div>
</section>
</section>
<section id="testbed-design" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Testbed Design</h1>
<section id="pcb-design-for-a-board-to-evaluate-the-adc-ads1115" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="pcb-design-for-a-board-to-evaluate-the-adc-ads1115"><span class="header-section-number">13.1</span> PCB Design for a Board to Evaluate the ADC ADS1115</h2>
<p>This Board was designed by us and aims to build a solid base to reduce parasitic effects like stray inductance etc. in comparison to a breadboard prototype and allow the user to take more accurate and reproducible measurements of the ADC. On this playform the ADS1115 as well as our IC can be tested when the IC is produced and then packaged.</p>
</section>
<section id="design-steps" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="design-steps"><span class="header-section-number">13.2</span> Design Steps</h2>
<p>First we fixed the design requirements and added following components into the list of parts on our board:</p>
<table class="caption-top table">
<caption>Table 1: Components</caption>
<thead>
<tr class="header">
<th>Component</th>
<th>Product Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ADC</td>
<td>ADS1115</td>
</tr>
<tr class="even">
<td>Accelerometer</td>
<td>ADXL335</td>
</tr>
<tr class="odd">
<td>LDO</td>
<td>AZ1117CH-3.3TRG1</td>
</tr>
<tr class="even">
<td>Main Connector</td>
<td>USB-C</td>
</tr>
<tr class="odd">
<td>MCU</td>
<td>ESP8266-12E/ESP-12E</td>
</tr>
<tr class="even">
<td>Signal Connectors</td>
<td>SMA Connector</td>
</tr>
<tr class="odd">
<td>USB-to-UART Converter</td>
<td>CP2102-GM</td>
</tr>
<tr class="even">
<td>Power In Connector</td>
<td>Male Pin Headers</td>
</tr>
</tbody>
</table>
</section>
<section id="additional-features" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="additional-features"><span class="header-section-number">13.3</span> Additional Features</h2>
<p>We also added the following features to this board. Even tho this is a relatively simple board we want to have this features anyway:</p>
<ul>
<li>Reverse polarity protection at the power input</li>
<li>ESD protection on important nodes</li>
<li>EMI protection</li>
<li>LEDs to show the status of the LDO and debug the MCU</li>
<li>Tight coupling to ground of signals (using a four layer PCB instead of a two layer board)</li>
<li>Clean and uninterupted reference plane</li>
<li>Four layer board from EU</li>
<li>LEDs on UART lines between USB-to-UART Converter and ESP8266</li>
</ul>
</section>
<section id="block-diagram" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="block-diagram"><span class="header-section-number">13.4</span> Block Diagram</h2>
<p>Here we have a visualisation of the board in the form of a block diagram. This allows the user and designers to quickly grasp the concept and order of the board and understand the system. Also this is usually thie first step in designing electronic systems as well as software since it gives a good overview.</p>
<div id="fig-Block-diagram-Credit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Block-diagram-Credit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/ac_Block_diagram_2.jpeg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Block-diagram-Credit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: Block diagram, Credit to: Mustafa Alkaya
</figcaption>
</figure>
</div>
</section>
<section id="schematic" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="schematic"><span class="header-section-number">13.5</span> Schematic</h2>
<p>The schematic consists of four pages in total and is in an hierachical order. On the title page we can find informations of the board and a block diagram of the schematic. In the input and voltage regulator section there is the USB-C connector and the male pinheader. Here we can also find the reverse polarity protection in the form of a schottky diode and TVS diodes for ESD protection. Schottky diodes have a smaller forward voltage drop than silicon diodes and were choosen because of this. Further the 3.3V LDO and LEDs are implemented here. We used net labels to clarify names of nets in the PCB editor. Ports are being used to connect signals and power rails across the project between multiple schematic pages. The USB connector has two 5.1k<span class="math inline">\(\Omega\)</span> to negotiate 5V and up to 1.5A from the USB supply device.</p>
<div id="fig-Ttile-Page" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ttile-Page-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_Title_Page.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ttile-Page-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: Title page
</figcaption>
</figure>
</div>
</section>
<section id="input-power-regulation-and-usb-c-connector" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="input-power-regulation-and-usb-c-connector"><span class="header-section-number">13.6</span> Input, Power Regulation and USB-C Connector</h2>
<p>The schematic in the diagram illustrates the power management and input/output configurations of a circuit design in detail. The “USB-C Power and Programming” section includes circuit components that provide power supply and data communication through a USB-C connection. The “Voltage Supply Input” section ensures the regulation and protection of the input voltage, incorporating components for overcurrent and overvoltage protection. The “3.3V Voltage Regulator” section features a regulator circuit that steps down the 5V input voltage to 3.3V, along with filtering capacitors. Finally, the “Power Connections” section displays the connections of various voltage levels to other circuit modules. This design aims to deliver a compact and protected power management solution.</p>
<div id="fig-Ttile-Page-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ttile-Page-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_Input.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ttile-Page-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: Title page
</figcaption>
</figure>
</div>
</section>
<section id="esp8266-and-usb-to-uart" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="esp8266-and-usb-to-uart"><span class="header-section-number">13.7</span> ESP8266 and USB-to-UART</h2>
<p>The ESP8266 Page contains the microcontroller and USB-to-UART converter IC in order to communicate with the MCU over the USB port and a PC. This part was mostly taken from the ESP8266 reference design schematic.</p>
<div id="fig-ESP8266-and-USB" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ESP8266-and-USB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_ESP.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ESP8266-and-USB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: ESP8266 and USB-to-UART
</figcaption>
</figure>
</div>
</section>
<section id="adc-accelerometer-and-sma-signal-input-connectors" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="adc-accelerometer-and-sma-signal-input-connectors"><span class="header-section-number">13.8</span> ADC, Accelerometer and SMA Signal Input Connectors</h2>
<p>The ADC page contains the ADC ADS1115IDGST itself as well as four SMA connectors to connect to an external signal generator for example. There is also the accelerometer ADXL335BCPZ which can be utilized to aquire signals for the ADC. The connections can be configured by solder jumpers. This gives us the ability to quickly solder and desolder connections without using additional jumpers or 0 <span class="math inline">\(\Omega\)</span> resistors for example. The SMA connector inputs are also protected by TVS diodes against ESD. This ensures reliable operation of the ADC and other ICs.</p>
<div id="fig-Accelerometer-and-SMA-Signal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Accelerometer-and-SMA-Signal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_ADC.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Accelerometer-and-SMA-Signal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: ADC, Accelerometer and SMA Signal Input Connectors
</figcaption>
</figure>
</div>
</section>
<section id="pcb-design" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="pcb-design"><span class="header-section-number">13.9</span> PCB Design</h2>
<p>After designing the complete circuit in the schematic editor we checked for errors and annotated the schematics. Annotion means assigning each part an individual number to be able to seperate them. Then we did coarse placement of the components and then adjusted the footprints and did the fine placement.</p>
<p>It’s important to place decoupling capacitors close to the respective ICs so they have small parasitic inductance and therefore better power delivery when digital ICs are switching and also analog ICs are pulling higher currents. Additional capacitors reduce voltage drop whenever a device or IC is pulling current from the supply traces. Also we made sure to have a transmission via to all signal vias whenever we are changing signal layer so the signal is always referenced to ground and electric and magnetic fields are contained in a small area. This also helps with crosstalk and noise reduction.</p>
<p>Around the board we added stitching vias to stitch the ground layers together and created a faraday cage in order to stop incoming em-waves from disturbing our analog and digital signals. Traces can and will act like antennas and we need to be careful with this. The distance of the vias around the edges of the board can be calculated with the following formula:</p>
<p><span class="math display">\[
L = \frac{1}{20} \cdot \frac{c}{\sqrt{\epsilon_{r_eff}} \cdot f_{max}} \tag{44}
\]</span></p>
<p>where</p>
<ul>
<li>c = speed of light (<span class="math inline">\(3\cdot 10^{8}\)</span> m/s)</li>
<li><span class="math inline">\(\epsilon_{r\_eff}\)</span> = effective dielectric constant of the PCB (for FR4 = 4.6)</li>
<li><span class="math inline">\(f_{max}\)</span> = highest frequency of the RF circuit operation (Hz)</li>
</ul>
<p>with <span class="math inline">\(f_{max}\)</span> being the highest analog or digital frequency. The highest digital frequency is contained in the rising and falling edges and can therefore be much higher than the digital signal frequency itself.</p>
<p>The following pictures show the PCB:</p>
<div id="fig-2D-View-of-the-top" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2D-View-of-the-top-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_PCB1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2D-View-of-the-top-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: 2D-View of the top copper layer
</figcaption>
</figure>
</div>
<p>This is the Top and Bottom Layers in the 2D view in Altium Designer</p>
<div id="fig-Bottom-copper" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Bottom-copper-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_PCB2.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Bottom-copper-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: Bottom copper layer
</figcaption>
</figure>
</div>
<p>This picture shows the top copper layer</p>
<div id="fig-Top-copper-without" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Top-copper-without-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_PCB3.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Top-copper-without-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.8: Top copper without the ground copper pour
</figcaption>
</figure>
</div>
<p>The next two pictures show the voltage drop on the 3.3V rails when the ESP and both ICs pull their respective currents. THe lowest voltage here is 3.29V. This can be important whenever high precision is needed for the ADCs since they compare the voltage on the inputs to the ADC reference voltage.</p>
<div id="fig-Voltage-drop-simulation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Voltage-drop-simulation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_PCB4.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Voltage-drop-simulation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.9: Voltage drop simulation of the top copper layer power traces
</figcaption>
</figure>
</div>
<div id="fig-Voltage-drop-simulation-of-the-bottom" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Voltage-drop-simulation-of-the-bottom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_PCB5.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Voltage-drop-simulation-of-the-bottom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.10: Voltage drop simulation of the bottom copper layer
</figcaption>
</figure>
</div>
<p>In this last picture we can see the 3D rendered view from Altium Designer of our board.</p>
<div id="fig-3D-View-of-out-PCB" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-3D-View-of-out-PCB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figures/ac_PCB6.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-3D-View-of-out-PCB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.11: 3D-View of out PCB
</figcaption>
</figure>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-SQRLaw" class="csl-entry" role="listitem">
Alan Doolittle. 2025. <span>“<span class="nocase">Lecture 25 - MOSFET Basics (Understanding with Math</span>.”</span> <a href="https://alan.ece.gatech.edu/ECE3040/Lectures/Lecture25-MOSTransQuantitativeId-Vd-Vg.pdf" class="uri">https://alan.ece.gatech.edu/ECE3040/Lectures/Lecture25-MOSTransQuantitativeId-Vd-Vg.pdf</a>.
</div>
<div id="ref-schmittcurve" class="csl-entry" role="listitem">
Allelco. 2025. <span>“<span class="nocase">Schmitt Triggers in Modern Electronics: Understanding Their Role and Capabilities</span>.”</span> <a href="https://www.allelcoelec.com/blog/schmitt-triggers-in-modern-electronics-understanding-their-role-and-capabilities.html" class="uri">https://www.allelcoelec.com/blog/schmitt-triggers-in-modern-electronics-understanding-their-role-and-capabilities.html</a>.
</div>
<div id="ref-bajdechi2004systematic" class="csl-entry" role="listitem">
Bajdechi, Ovidiu. 2004. <span>“Systematic Design of Sigma-Delta Analog-to-Digital Converters.”</span> In <em>Analog Circuit Design: Sensor and Actuator Interface Electronics, Integrated High-Voltage Electronics and Power Management, Low-Power and High-Resolution ADC’s</em>, edited by Michiel Steyaert, Arthur H. M. van Roermund, and Herman Casier, 293–326. Springer. <a href="https://doi.org/10.1007/978-1-4020-7997-5_13">https://doi.org/10.1007/978-1-4020-7997-5_13</a>.
</div>
<div id="ref-baker2011delta" class="csl-entry" role="listitem">
Baker. 2011. <span>“How Delta-Sigma ADCs Work, Part 1.”</span> <em>Analog Applications</em> 7.
</div>
<div id="ref-Baker2008" class="csl-entry" role="listitem">
Baker, R. Jacob. 2008. <em>CMOS: Circuit Design, Layout, and Simulation</em>. Wiley-IEEE Press. <a href="https://www.wiley.com/en-us/CMOS%3A+Circuit+Design%2C+Layout%2C+and+Simulation%2C+3rd+Edition-p-9780470290260">https://www.wiley.com/en-us/CMOS%3A+Circuit+Design%2C+Layout%2C+and+Simulation%2C+3rd+Edition-p-9780470290260</a>.
</div>
<div id="ref-MurmannGmId" class="csl-entry" role="listitem">
Boris Murmann. 2016. <span>“<span class="nocase">Systematic Design of Analog Circuits Using Pre-Computed Lookup Tables</span>.”</span> <a href="https://www.ieeetoronto.ca/wp-content/uploads/2020/06/20160226toronto_sscs.pdf" class="uri">https://www.ieeetoronto.ca/wp-content/uploads/2020/06/20160226toronto_sscs.pdf</a>.
</div>
<div id="ref-EE628" class="csl-entry" role="listitem">
———. 2024. <span>“<span class="nocase">EE 628 - University of Hawai’i as Manoa, Analysis and Design of Integrated Circuits</span>.”</span> <a href="https://github.com/bmurmann/EE628/tree/main/1_Lectures" class="uri">https://github.com/bmurmann/EE628/tree/main/1_Lectures</a>.
</div>
<div id="ref-Boser1988" class="csl-entry" role="listitem">
Boser, B. E., and B. A. Wooley. 1988. <span>“The Design of Sigma-Delta Modulation Analog-to-Digital Converters.”</span> <em>IEEE Journal of Solid-State Circuits</em> 23 (6): 1298–308. <a href="https://doi.org/10.1109/4.90025">https://doi.org/10.1109/4.90025</a>.
</div>
<div id="ref-cmosadc" class="csl-entry" role="listitem">
Chae, Youngcheol, Jimin Cheon, Seunghyun Lim, Minho Kwon, Kwisung Yoo, Wunki Jung, Dong-Hun Lee, Seogheon Ham, and Gunhee Han. 2011. <span>“A 2.1 m Pixels, 120 Frame/s CMOS Image Sensor with Column-Parallel <span class="math inline">\(\Delta \Sigma\)</span> ADC Architecture.”</span> <em>IEEE Journal of Solid-State Circuits</em> 46 (1): 236–47. <a href="https://doi.org/10.1109/JSSC.2010.2085910">https://doi.org/10.1109/JSSC.2010.2085910</a>.
</div>
<div id="ref-Clifford2016" class="csl-entry" role="listitem">
Clifford, Michael. 2016. <span>“Fundamental Principles Behind the Sigma-Delta ADC Topology: Part 1.”</span> Analog Devices (AD). <a href="https://www.analog.com/en/resources/technical-articles/behind-the-sigma-delta-adc-topology.html">https://www.analog.com/en/resources/technical-articles/behind-the-sigma-delta-adc-topology.html</a>.
</div>
<div id="ref-Dobkin2011" class="csl-entry" role="listitem">
Dobkin, Bob, and Jim Williams. 2011. <em>Analog Circuit Design: A Tutorial Guide to Applications and Solutions</em>. Elsevier/Newnes. <a href="https://www.elsevier.com/books/analog-circuit-design/dobkin/978-0-12-385185-7">https://www.elsevier.com/books/analog-circuit-design/dobkin/978-0-12-385185-7</a>.
</div>
<div id="ref-aabo" class="csl-entry" role="listitem">
Dr. Andrew Masami Abo. 1992. <span>“<span class="nocase">Design for Reliability of Low-voltage, Switched-capacitor Circuits</span>.”</span> <a href="https://designers-guide.org/forum/Attachments/SC_Dissertation.pdf" class="uri">https://designers-guide.org/forum/Attachments/SC_Dissertation.pdf</a>.
</div>
<div id="ref-schmitt" class="csl-entry" role="listitem">
Filanovsky, M., and H. Baltes. 2004. <span>“Theory and Applications of Incremental <span class="math inline">\(\Delta\Sigma\)</span> Converters.”</span> <em>IEEE Transactions on Circuits and Systems-1: FUNDAMENTAL THEORY AND APPLICATIONS</em> 41 (1): 46–49. <a href="http://web.mit.edu/magic/Public/papers/00260219.pdf">http://web.mit.edu/magic/Public/papers/00260219.pdf</a>.
</div>
<div id="ref-vcoring" class="csl-entry" role="listitem">
G. Jovanovic, Mile Stojcev, and Zoran Stamenkovic. 2010. <span>“A CMOS Voltage Controlled Ring Oscillator with Improved Frequency Stability.”</span> <em>Scientific Publications of the State University of Novi Pazar Series A Applied Mathematics Informatics and Mechanics</em> 2 (0): 1–9. <a href="https://www.researchgate.net/publication/266265623_A_CMOS_Voltage_Controlled_Ring_Oscillator_with_Improved_Frequency_Stability?enrichId=rgreq-ea65c1847781412dd1f866311352b440-XXX&amp;enrichSource=Y292ZXJQYWdlOzI2NjI2NTYyMztBUzoxNDc0MTUzNDA0MjUyMTdAMTQxMjE1Nzk2NDc3NA%3D%3D&amp;el=1_x_3&amp;_esc=publicationCoverPdf">https://www.researchgate.net/publication/266265623_A_CMOS_Voltage_Controlled_Ring_Oscillator_with_Improved_Frequency_Stability?enrichId=rgreq-ea65c1847781412dd1f866311352b440-XXX&amp;enrichSource=Y292ZXJQYWdlOzI2NjI2NTYyMztBUzoxNDc0MTUzNDA0MjUyMTdAMTQxMjE1Nzk2NDc3NA%3D%3D&amp;el=1_x_3&amp;_esc=publicationCoverPdf</a>.
</div>
<div id="ref-Gift2022" class="csl-entry" role="listitem">
Gift, Stephan J. G. and Maundy, Brent. 2022. <span>“<span>Operational Amplifiers</span>.”</span> In <em><span class="nocase">Electronic Circuit Design and Application</span></em>, 325–73. Cham: <a href="https://doi.org/10.1007/978-3-030-79375-3_8" class="uri">https://doi.org/10.1007/978-3-030-79375-3_8</a>; <span>Springer International Publishing</span>. <a href="https://doi.org/10.1007/978-3-030-79375-3_8">https://doi.org/10.1007/978-3-030-79375-3_8</a>.
</div>
<div id="ref-goldenbaum2022grundlagen" class="csl-entry" role="listitem">
Goldenbaum, Prof. Dr.-Ing. Mario. 2022. <span>“Grundlagen Der Informationstechnik.”</span>
</div>
<div id="ref-IIC_OSIC_TOOLS" class="csl-entry" role="listitem">
H. Pretl. 2025. <span>“<span>IIC-OSIC-TOOLS</span>.”</span> <a href="https://github.com/iic-jku/IIC-OSIC-TOOLS" class="uri">https://github.com/iic-jku/IIC-OSIC-TOOLS</a>.
</div>
<div id="ref-hpretlacd" class="csl-entry" role="listitem">
H. Pretl and Michael Koefinger. 2025. <span>“<span>Analog Circuit Design</span>.”</span> <a href="https://iic-jku.github.io/analog-circuit-design/" class="uri">https://iic-jku.github.io/analog-circuit-design/</a>.
</div>
<div id="ref-IHP_SG13G2" class="csl-entry" role="listitem">
IHP. 2025. <span>“<span class="nocase">SiGe BiCMOS and Silicon Photonics Technologies</span>.”</span> <a href="https://www.ihp-microelectronics.com/services/research-and-prototyping-service/mpw-prototyping-service/sigec-bicmos-technologies" class="uri">https://www.ihp-microelectronics.com/services/research-and-prototyping-service/mpw-prototyping-service/sigec-bicmos-technologies</a>.
</div>
<div id="ref-IHP-Pricing" class="csl-entry" role="listitem">
IHP GmbH. 2025. <span>“<span class="nocase">MPW-Zeitplan 2024 &amp; 2025 und Preisinformationen 2024</span>.”</span> <a href="https://www.ihp-microelectronics.com/de/leistungen/forschungs-und-prototyping-service/mpw-prototyping-service/zeitplan-preisliste#c1379" class="uri">https://www.ihp-microelectronics.com/de/leistungen/forschungs-und-prototyping-service/mpw-prototyping-service/zeitplan-preisliste#c1379</a>.
</div>
<div id="ref-kester2005data" class="csl-entry" role="listitem">
Kester, Walt. 2005. <em>The Data Conversion Handbook</em>. Burlington, MA: Newnes/Elsevier.
</div>
<div id="ref-incrementaldsm" class="csl-entry" role="listitem">
Markus, J., J. Silva, and G. C. Temes. 2004. <span>“Theory and Applications of Incremental <span class="math inline">\(\Delta\Sigma\)</span> Converters.”</span> <em>IEEE Transactions on Circuits and Systems I: Regular Papers</em> 51 (4): 678–90. <a href="https://doi.org/10.1109/TCSI.2004.826202">https://doi.org/10.1109/TCSI.2004.826202</a>.
</div>
<div id="ref-integrated2003demystifying" class="csl-entry" role="listitem">
Maxim. 2003. <span>“Demystifying Delta-Sigma ADCs.”</span> Tutorial 1870. Maxim Integrated.
</div>
<div id="ref-meyer2019kommunikationstechnik" class="csl-entry" role="listitem">
Meyer, Martin. 2019. <em>Kommunikationstechnik: Konzepte Der Modernen Nachrichtenübertragung</em>. Wiesbaden: Springer Vieweg.
</div>
<div id="ref-mitra2001digital" class="csl-entry" role="listitem">
Mitra, Sanjit K. 2001. <em>Digital Signal Processing: A Computer-Based Approach</em>. McGraw-Hill Higher Education.
</div>
<div id="ref-pavan2017understanding" class="csl-entry" role="listitem">
Pavan, Shanthi, Richard Schreier, and Gabor C. Temes. 2017. <em>Understanding Delta-Sigma Data Converters</em>. IEEE Press Series on Microelectronic Systems. John Wiley &amp; Sons.
</div>
<div id="ref-strongARM" class="csl-entry" role="listitem">
Razavi, Behzad. 2015. <span>“The StrongARM Latch [a Circuit for All Seasons].”</span> <em>IEEE Solid-State Circuits Magazine</em> 7 (2): 12–17. <a href="https://doi.org/10.1109/MSSC.2015.2418155">https://doi.org/10.1109/MSSC.2015.2418155</a>.
</div>
<div id="ref-delarosa2011sigmadelta" class="csl-entry" role="listitem">
Rosa, Jose M. de la. 2011. <span>“Sigma-Delta Modulators: Tutorial Overview, Design Guide, and State-of-the-Art Survey.”</span> <em>IEEE Journal of Circuits and Systems</em> 58 (1): 1–21. <a href="https://ieeexplore.ieee.org/document/5672380">https://ieeexplore.ieee.org/document/5672380</a>.
</div>
<div id="ref-delarosa2013" class="csl-entry" role="listitem">
Rosa, Jose M. de la, and Rocío del Río. 2013. <em>CMOS Sigma-Delta Converters: Practical Design Guide</em>. John Wiley &amp; Sons, Ltd. https://doi.org/<a href="https://doi.org/10.1002/9781118569221">https://doi.org/10.1002/9781118569221</a>.
</div>
<div id="ref-RWalker" class="csl-entry" role="listitem">
Ross Walker. 2017. <span>“<span class="nocase">Chapter 5, gm/ID - Based Design</span>.”</span> <a href="https://web02.gonzaga.edu/faculty/talarico/EE406/documents/gmid.pdf" class="uri">https://web02.gonzaga.edu/faculty/talarico/EE406/documents/gmid.pdf</a>.
</div>
<div id="ref-schreier2005understanding" class="csl-entry" role="listitem">
Schreier, Richard, Gabor C Temes, et al. 2005. <em>Understanding Delta-Sigma Data Converters</em>. Vol. 74. IEEE press Piscataway, NJ.
</div>
<div id="ref-gmId" class="csl-entry" role="listitem">
Silveira, F., D. Flandre, and P. G. A. Jespers. 1996. <span>“A Gm/Id Based Methodology for the Design of CMOS Analog Circuits and Its Application to the Synthesis of a Silicon-on-Insulator Micropower OTA.”</span> <em>IEEE Journal of Solid-State Circuits</em> 31 (9): 1314–19. <a href="https://doi.org/10.1109/4.535416">https://doi.org/10.1109/4.535416</a>.
</div>
<div id="ref-williams2006electronic" class="csl-entry" role="listitem">
Williams, Arthur, and Fred J. Taylor. 2006. <em>Electronic Filter Design Handbook, Fourth Edition</em>. 4th ed. McGraw-Hill Professional.
</div>
<div id="ref-wolter2023dsp2" class="csl-entry" role="listitem">
Wolter, Stefan. 2023. <span>“Digital Signal Processing II – Lecture Slides.”</span> University of Applied Sciences Bremen. <a href="https://wolter.hs-bremen.de/skripte/DSP_II/">https://wolter.hs-bremen.de/skripte/DSP_II/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mimeiners\.github\.io\/cems\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lec/lec-01-intro.html" class="pagination-link" aria-label="Introduction and Survey">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction and Survey</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../lab/elie2/index.html" class="pagination-link" aria-label="Discrete-Time Delta-Sigma Modulator">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Discrete-Time Delta-Sigma Modulator</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Concept Engineering Mixed-Technology Systems</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mimeiners/cems/edit/main/lab/elie1/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mimeiners/cems/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>